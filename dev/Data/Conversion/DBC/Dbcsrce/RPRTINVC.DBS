..................................................................
.   ORDER PROCESSING SYSTEM......INVOICE MAILER	 R E P R I N T
.
.   RPRTINVC/TEXT  - 5/25/91
. 
	 INCLUDE   MSCBRAG.TXT
. 
	 INCLUDE   COMMON
. 
INVCNUMB DIM	    5
PASSDT6	 DIM	   6
PASSACCT DIM	   4
PASSCOMP DIM	   1
PASSCUST DIM	   30
. 
NINVCNO	 DIM	   5
NEWFKEY	 DIM	   5
.
INDX1	 FORM	   1
RECCNTR	 FORM	   2
.
REPLY	 DIM	   1
.FIELD	 TYPE	   LENGTH    FROM-TO   DESCRIPTION
.-----	 ----	   ------    -------   -----------
WORK01	 DIM	    1
WORK02	 DIM	    2
WORK03	 DIM	    3
WORK04	 DIM	    4
WORK08	 DIM	    8
WORK10	 DIM	   10
WORK09	 DIM	   9
FIELD09	 DIM	   7
NFIELD09 FORM	   7
.
DATE8	 DIM	   8		8 DIGIT	DATE WORK FIELD
MM	 DIM	   2
DD	 DIM	   2
YY	 DIM	   2
XMM	 DIM	   2
XDD	 DIM	   2
XYY	 DIM	   2
FORM5	 FORM	   5
. 
DTYPE	 DIM	   8
DSTAT	 DIM	   10
INDX	 FORM	   2
STARTKEY DIM	   5
PP	 DIM	   1
PC	 DIM	   1
LINES	 FORM	   2
PTERMS	 DIM	   18
HDRSW	 DIM	   1
PAGES	 FORM	   2
. 
	 INCLUDE   PART
. 
. CONTROL FILE AREA
. 
	 INCLUDE   CONTFILE
. 
NFIELD01 FORM	    4		       (NUMERIC	WORK FIELD)
FIELD01	 DIM	    4
. 
NFLD01	 FORM	   9
FLD01	 DIM	   9
. 
MULTIFLG DIM	   1
MULTIROW FORM	   2
MULTICNT FORM	   2
MULTIDSC DIM	   25
MD1	 DIM	   25
MD2	 DIM	   25
MD3	 DIM	   25
MD4	 DIM	   25
MD5	 DIM	   25
MD6	 DIM	   25
MD7	 DIM	   25
MD8	 DIM	   25
MD9	 DIM	   25
MD10	 DIM	   25
EXTRA	 INIT	   "XXXXXXXXXXXXXXXXXXX"
COMPLETE DIM	   1
UOM	 DIM	   2
PRODCODE DIM	   2
SHIPNAME DIM	   30
SHIPADDR DIM	   25
SHIPYADR DIM	   25
SHIPADR2 DIM	   25
SHIPCITY DIM	   18
SHIPSTAT DIM	   2
SHIPZIP	 DIM	   5
COMPLET	 DIM	   1
. 
NORMTERM INIT	   "2%15NET30"
.
SOHDRFL	 IFILE	   KEYL=5,UNCOMPRESSED
SOHDRNM	 INIT	   "C:\DBC\SOHDRFL.ISI"
.
SOHDRKY	 DIM	   5
SOLINES	 DIM	   2
SOHDRNO	 DIM	   5
.
.
SODTLFL	 IFILE	   KEYL=8,UNCOMPRESSED
SODTLNM	 INIT	   "C:\DBC\SODTLFL.ISI"
.
SODTLKY	 DIM	   8  (SO#/SOLN#/MULTI-DESC-SUFFIX [0-9])
.
SODTLSTA DIM	   1
SODTLNO	 DIM	   5
SODTLLN	 DIM	   2
SODTLSFX DIM	   1
NEWTERM	 DIM	   15
PTERM	 DIM	   9
. ACCOUNT FILE READ/WORK AREA
. 
CUSTFILE IFILE	   KEYL=4,UNCOMPRESSED
CSTNAME	 INIT	   "C:\DBC\ACCOUNTS.ISI"
. 
	 INCLUDE   CUSTMAST
.
CLOSESW	 INIT	   " "
. 
ADDKEY	 FORM	   5	       INCREMENT WORK FIELD FOR	NUMBERS
.
NEWFILE	 IFILE	   KEYL=5,UNCOMPRESSED
NEWFNAME INIT	   "C:\DBC\NEWINVCS.ISI"
.
INSERTFL IFILE	   KEYL=10,UNCOMPRESSED
INSERTNM INIT	   "C:\DBC\ARFILEXX.ISI"
INSERTKY DIM	   10
.
ARFILEDT IFILE	   KEYL=11,UNCOMPRESSED
ARFLDTNM INIT	   "C:\DBC\ARFILEDT.ISI"
ARFLDTKY DIM	   11
.
.  WORK	 AREAS FOR INVOICE HEADER CREATION/WRITE
. 
	 INCLUDE   RCVBLES
. 
SAVE	 DIM	     10
TOTDOLS	 FORM	     6.2
FRGHT	 FORM	     2.2
. 
OLDDET	 DIM	   1
IOSW	 DIM	   1
LIBNET	 FORM	   7.2
REPNET	 FORM	   7.2
INVNET	 FORM	   7.2
. 
+...........................................................
. 
DATE2X	 DIM	   2
DATE2N	 FORM	   2
. 
. 
INVCKEGS FORM	   7	 (ORDER	QTY)
PCSSOLD	 FORM	   7	 (SHIPPED QTY)
INVPCSKG FORM	   7	 (BACKORDER QTY)
. 
BUILDPT	 DIM	   7
. 
. RECORD ASSEMBLY AREA
.	    INVOICE DETAIL DETAIL RECORD = 45 BYTES
. 
INVCNO	 DIM	   5		       INVC NUMBER
INVCLINE DIM	   2		       INVC LINE NUMBER	SUFFIX FOR INDEXING
. 
.  NOTE	THAT INVCLINE WILL BE A	2 DIGIT	NUMERIC	SUFFIX
.  COUNTER-CREATED IN THIS PROGRAM
. 
INVLINES FORM	   "00"
IRECCNTR FORM	   6
DTLSTAT	 DIM	   1
ILIVCNTR FORM	   3
. 
ROW	 FORM	   2		    USED TO ROLL DOWN THE KEYIN	STMT
. 
NFIELD04 FORM	    5.2		       (NUMERIC	WORK FIELD)
FIELD04	 DIM	    8	      11- 18   PRICE LN	1		  5.2
NFIELD03 FORM	    3
FIELD03	 DIM	    3
NFIELD02 FORM	    4
FIELD02	 DIM	    4
. 
. EXTENSION CALCULATE WORK/DISPLAY AREA
. 
LNDOLS	 FORM	   5.2
KEGQTY	 FORM	   9
LINECOST FORM	   6.2
KGSAVAIL FORM	   6
CRAPMSG	 DIM	   18
.
CALCFLD	 FORM	   8.3
CALCFLD1 FORM	   8.3
.
OLDFRGT	 FORM	   5.2
. 
FORM3	 FORM	   3
IPNSTDSX DIM	   6
IPNSTDSN FORM	   6
NONSTDSW DIM	   1
SCANSW	 DIM	   1
PARTUPSW DIM	   1
. 
KREPLY	 DIM	   1
. 
CHKPASS	 DIM	   5
.  
WEIGHT	 FORM	   6
HDRCHGSW DIM	   1
DUMMY	 DIM	   40
. 
INVDTKEY DIM	   7
. 
OLDXTEND FORM	   6.2
. 
. 
CALCNET	 FORM	   6.2
FRTALLOW FORM	   5.2
. 
TIMEDIM	 DIM	   8
EOJSW	 DIM	   1
. 
CUSTN	 FORM	   4
SPECMSG	 DIM	   80
MSGFLAG	 DIM	   1
PORTX	 DIM	   2
SPECSW	 DIM	   1
TIME	 INIT	   "HH/MM/SS"
ALIGNSW	 DIM	   1
. 
+........................................................................
. 
START	 DISPLAY   *ES,*P01:12,*HON," I	N V O I	C E   R	E P R I	N T PROGRAM":
		   *HOFF:
		       *P01:14,"IF YOU HAVE COME HERE ERRONEOUSLY FROM THE ":
			       "SYSTEM MENU PROGRAMS":
		       *P01:15,"AND DO	N O T  HAVE ANY	 INVOICES TO ":
			       "ENTER........":
		       *P01:17,"YOU MAY	TERMINATE THIS PROGRAM BY PRESSING ":
			       "THE   F5   KEY"
	 KEYIN	   *P01:20,*HON,"KEY	 F5	TO  TERMINATE":
		   *P01:21,"KEY	 ENTER	TO PRINT INVOICE MAILERS ",*HOFF,REPLY
. 
	 GOTO	   MAINLINE  IF	 NOT  F5
. 
	 BEEP
INDXIT	 DISPLAY   *ES
	 BEEP
	 CHAIN	   "APPINVC1"
.
MAINLINE MOVE	   " " TO REPLY
.
	 BEEP
	 DISPLAY   *ES,*HON,*P10:1,"INVOICE MAILER   R E P R I N T PROGRAM":
		       *P1:3,"*** IMPORTANT ***	- SET PRINTER TO 8 LINES PER ":
			     "INCH  N O	W !":
		       *P1:5,"LOAD INVOICE MAILERS AND SET LEFT	MARGIN AT ":
			     "MINUS 5 (-5)":
		       *P1:6,"SET TOP OF PRINT HEAD  J U S T  BELOW THE	TOP ":
			     " OF THE  - A - GLOBE ":
		       *P1:7,"PRESS ENTER WHEN READY TO	PROCEED	OR F5 TO ":
			     "TERMINATE	",*HOFF:
		       *P1:10,"D O N T	 D O N T   D O N T ":
		       *P1:11,"----------------------------":
		       *P1:12,"	     F O R G E T   F O R G E T	 F O R G E T":
		       *P1:13,"----------------------------------------------":
		       *P1:14,"		   S E T   P R I N T E R   S E T   P":
			      "	R I N T	E R":
		       *P1:15,"----------------------------------------------":
			      "------------":
		       *P1:16,"		     T O   8  L	I N E S	/ I N C	H":
			      "	   T O	 8  L I	N E S /	I N C H":
		       *P1:17,"-------------------------------------------":
			      "--------------------------------"
	 KEYIN	   *P55:7,REPLY
	 GOTO	   INDXIT IF F5
.
	 MOVE	   " ",REPLY
	 MOVE	   " ",MSGFLAG
	 MOVE	   " ",SPECMSG
	 GOTO	   OPENFLS
. 
. FILE OPENING SEQUENCE
OPENFLS	 TRAP	   NOFILE  IF IO
. 
	 OPEN	   SOHDRFL,SOHDRNM
.
	 OPEN	   SODTLFL,SODTLNM
.
	 MOVE	   TODAY TO MM
	 MOVE	   TODAY TO XMM
	 RESET	   TODAY TO 4
	 MOVE	   TODAY TO DD
	 MOVE	   TODAY TO XDD
	 RESET	   TODAY TO 7
	 MOVE	   TODAY TO YY
	 MOVE	   TODAY TO XYY
	 RESET	   TODAY TO 1
. 
. SET UP SIX DIGIT DATE
. 
	 MOVE	   TODAY TO DATE8
	 MOVE	   DATE8 TO INVDATE
	 BUMP	   DATE8 BY 3
	 RESET	   INVDATE TO 2
	 APPEND	   DATE8 TO INVDATE
	 BUMP	   DATE8 BY 3
	 RESET	   INVDATE TO 4
	 APPEND	   DATE8 TO INVDATE
	 RESET	   INVDATE
	 RESET	   DATE8
	 MOVE	   INVDATE  TO	PASSDT6	     PASS 6 DIGIT DATE TO DTL PGM
	 GOTO	   ACCTOPEN
.
NOFILE	 DISPLAY   *ES,"ORDER PROCESSING FILES NOT ON LINE":
		   *N,"JOB IS ABORTING"
	 BEEP
	 CHAIN	   "APPINVC1"	     GO	BACK TO	DISPLAY	INVOICE	MENU
*...........................................................
.
ALIGN	 CMOVE	   "X" TO ALIGNSW
	 DISPLAY   *P1:20,*EL,"ALIGNMENT OF THE	INVOICE	FORM",*W2
.
	 MOVE	   "XXXXX" TO  INVKEY
	 MOVE	   "XXXXXXXXXXXXXXX"  TO  INVORDNO
	 MOVE	   "XXXXXXXXXXXXXXX"  TO  INVSHIP
	 MOVE	   NORMTERM  TO	 NEWTERM
	 MOVE	   "1000"  TO  INVCKEGS
	 MOVE	   "1000"  TO  PCSSOLD
	 MOVE	   "0"	   TO  INVPCSKG
	 MOVE	   "TEST PART" TO MULTIDSC
	 MOVE	   ".10"   TO  LNDOLS
	 MOVE	   "EA"	   TO  UOM
	 MOVE	   "100.00"  TO	 LINECOST
	 MOVE	   "100.00"  TO	 LIBNET
	 MOVE	   "10"	     TO	 INVWGHT
	 MOVE	   "1"	     TO	 CARTONS
	 MOVE	   "TEST"    TO	 SOHDRNO
	 MOVE	   "TEST"    TO	 SODTLNO
.
ALIGN1	 MOVE	   "0001"  TO  CUSTKEY
	 CALL	   GETCUST
	 MOVE	   "X"	   TO  ALIGNSW
	 CALL	   HDINVCS
	 MOVE	   "X"	   TO  ALIGNSW
	 CALL	   DTL1
	 MOVE	   "X"	   TO  ALIGNSW
.
ALIGNASK BEEP
	 MOVE	   " "	TO  REPLY
	 KEYIN	   *P1:23,"ANOTHER ALIGNMENT TRY? (Y/N)	",REPLY
	 CMATCH	   "Y",REPLY
	 GOTO	   ALIGN1  IF  EQUAL
	 CMATCH	   "N",REPLY
	 GOTO	   ALIGNASK IF NOT EQUAL
.
	 CMOVE	   " " TO ALIGNSW
	 RETURN
.
. OPEN ISAM-LOOKUP FILE
.
ACCTOPEN TRAPCLR   IO
	 TRAP	   NOCUSTFL IF IO
.
	 CALL	   OPENCUST
.
	 CMATCH	   "H"	TO  IOSW
	 GOTO	   NOCUSTFL IF NOT EQUAL
.
	 TRAPCLR   IO
	 TRAP	   NOCTRLS IF IO
.
	 CALL	   OPENCTLS
.
	 CMATCH	   "H"	  TO IOSW
	 GOTO	   NOCTRLS IF NOT EQUAL
.
ZERONETS TRAPCLR   IO		     (OKAY NOW LETS GO!)
.
	 TRAPCLR   IO
	 CALL	   OPENRCVB
.
	 TRAPCLR   IO
	 TRAP	   NOARINDX IF IO
.
	 OPEN	   NEWFILE,NEWFNAME
.
	 OPEN	   INSERTFL,INSERTNM
.
	 OPEN	   ARFILEDT,ARFLDTNM
.
	 MOVE	   "A" TO INVCOMP
.
	 CALL	   ALIGN
.
	 GOTO	   DISPLAY
. 
.................................................
.
NOARINDX BEEP
	 DISPLAY   *P1:23,*EL,"BILLING INDEX FILES NOT ON LINE!	- ABORTING! ":
		   *W2
	 CHAIN	   "ARMENU1"
.
	 STOP
NOCTRLS	 DISPLAY   *ES," CONTROLS  FILE	IS NOT ON-LINE",*W,*W
	 BEEP
. 
MNUCHAIN CHAIN	   "APPINVC1"
. 
NOCUSTFL DISPLAY   *ES,"CUSTOMER FILE IS NOT ON-LINE, ABORTING"
	 BEEP
	 GOTO	   MNUCHAIN
. 
*...........................................................
. INITIAL SCREEN DISPLAY SEQUENCE
.
DISPLAY	 CLOCK	   TIME	TO TIME
	 DISPLAY   *P1:1,*HON,"R E P R I N T I N G  INVOICES  FOR SHIPMENTS":
			 *HOFF
	 GOTO	   ORDERFOR
.
ORDERFOR MOVE	   "A" TO INVCOMP
.
HDRLOOP	 READKS	   SOHDRFL;SOHDRNO,SOLINES,INVTYPE,INVSTAT,INVCUST:
			   INVDATE,INVTOTL,INVORDNO,INVWGHT,NEWTERM:
			   CARTONS,INVSHIP,COMPLET:
			   SHIPNAME,SHIPADDR,SHIPADR2:
			   SHIPCITY,SHIPSTAT,SHIPZIP:
			   CALCNET,LIBNET
. 
	 GOTO	   LASTEOJ  IF	OVER
.
.   PRINT INVOICE MAILER  R E G	A R D L	E S S  OF PACKING LIST STATUS CODE
.
.........	 MATCH	   "P"	TO  INVSTAT
.........	 GOTO	   HDRLOOP  IF	NOT  EQUAL
.
	 MOVE	   "0.00"  TO  INVNET
	 MOVE	   "0"	   TO  LINES
.
. SET KEY FOR DETAIL READS
.
SETDTLS	 CLEAR	   SODTLKY
	 APPEND	   SOHDRNO  TO	SODTLKY
	 APPEND	   "000"    TO	SODTLKY
	 RESET	   SODTLKY  TO	1
	 READ	   SODTLFL,SODTLKY;DUMMY    (REC NOT FND)
.
MOVREP	 MOVE	   "APP" TO CTLKEY
. 
PRNTINVC MOVE	   "000000.00" TO IAMTPD1
	 MOVE	   "000000.00" TO IAMTPD2
	 MOVE	   "000000.00" TO IAMTPD3
	 MOVE	   "000000.00" TO IAMTPD4
	 MOVE	   "000000.00" TO IAMTPD5
	 MOVE	   "	  "    TO ICHK1
	 MOVE	   "	  "    TO ICHK2
	 MOVE	   "	  "    TO ICHK3
	 MOVE	   "	  "    TO ICHK4
	 MOVE	   "	  "    TO ICHK5
	 MOVE	   "	  "    TO IDTPD1
	 MOVE	   "	  "    TO IDTPD2
	 MOVE	   "	  "    TO IDTPD3
	 MOVE	   "	  "    TO IDTPD4
	 MOVE	   "	  "    TO IDTPD5
	 MOVE	   "00000000"  TO IPRGDTE
	 MOVE	   "0"	       TO IPMNTS
	 MOVE	   SOHDRNO     TO INVKEY
	 MOVE	   INVKEY      TO STARTKEY  (SET THE ISAM ADD KEY)
	 MOVE	   " "	       TO HDRSW
	 MOVE	   "0"	       TO PAGES
	 GOTO	   PRNTS
. 
. NOW PRINT THE	INVOICE
. 
PRNTS	 MOVE	   SOHDRNO  TO	INVKEY
	 MOVE	   INVCUST  TO	CUSTKEY
	 CALL	   GETCUST
.
	 CMATCH	   "C",INVTYPE
	 CALL	   HDCREDS IF EQUAL
. 
	 CMATCH	   "I",INVTYPE
	 CALL	   HDINVCS IF EQUAL
. 
	 GOTO	   DETPRINT
.
...................................................................
. 
HDCREDS	 PRINT	   *65,"CREDIT",*74,"C",INVKEY,*83,TODAY,*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 GOTO	   ORDERLN
. 
HDINVCS	 PRINT	   *74,"A",INVKEY,*83,TODAY,*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
.
ORDERLN	 MOVE	   NEWTERM  TO PTERMS
	 PRINT	   *46,INVORDNO,*61,PTERMS,*70,INVWGHT," ",CARTONS,*82,INVSHIP
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 MOVE	   "8"	TO  LINES
	 RETURN
..................................................................
.
ADRPRINT PRINT	   " ",*FLUSH
	 PRINT	   *8,CUSTNAME,*41,SHIPNAME,*81,INVNET,*FLUSH
	 PRINT	   *8,CUSTADDR,*41,SHIPADDR,*FLUSH
	 PRINT	   *8,CUSTCITY," ",CUSTSTAT," ",*ZF,CUSTZIP:
		   *41,SHIPADR2,*FLUSH
	 PRINT	   *8,"ACCOUNTS	PAYABLE":
		   *41,SHIPCITY," ",SHIPSTAT," ",SHIPZIP,*FLUSH
	 PRINT	   " ",*FLUSH
	 ADD	   "6"	TO  LINES
	 RETURN
..................................................................
.
DETPRINT CLEAR	   SODTLKY
	 APPEND	   SOHDRNO  TO SODTLKY
	 APPEND	   "000"     TO	SODTLKY
	 RESET	   SODTLKY  TO 1
	 READ	   SODTLFL,SODTLKY;DUMMY    (REC NOT FND)
. 
DETLOOP	 READKS	   SODTLFL;SODTLNO,SODTLLN,SODTLSFX,DTLSTAT,MULTIDSC:
			   INVCKEGS,INVPCSKG,PCSSOLD:
			   LNDOLS,LINECOST,UOM,PRODCODE
.
	 GOTO	   SETEOJ  IF  OVER
.
MTCHNOS	 MATCH	   SOHDRNO TO SODTLNO
	 GOTO	   NODETS  IF  NOT  EQUAL
. 
	 CMATCH	   "D",DTLSTAT
	 GOTO	   DETLOOP IF EQUAL  (BYPASS DELETED RECORDS)
. 
	 CMATCH	   "*",DTLSTAT
	 GOTO	   DETLOOP IF EQUAL
. 
. NOW INCREMENT	THE TOTALS
. 
....DTL1     MOVE      LNDOLS  TO  LINECOST
.....	     MULTIPLY  PCSSOLD BY  LINECOST    (RECALCULATED THE LINE COST!)
.					   (IN CASE THE	QTY/PRICE MODIFIED)
DTL1	 INCLUDE   UOMCHK.TXT
.
DSPCOSTX PRINT	   *9,INVCKEGS,*19,PCSSOLD,*30,INVPCSKG,*40,MULTIDSC:
		   *67,LNDOLS,*78,UOM,*81,LINECOST
. 
	 ADD	   LINECOST  TO	 INVNET
. 
	 ADD	   "1" TO LINES
.
	 COMPARE   "27",LINES
	 GOTO	   NODETS  IF  NOT  LESS
.
	 CMATCH	   "X",ALIGNSW
	 GOTO	   NODETS  IF  EQUAL
.
	 GOTO	   DETLOOP
. 
CONTPRNT PRINT	   *40,MULTIDSC
.
	 ADD	   "1" TO LINES
.
	 COMPARE   "27",LINES
	 GOTO	   NODETS  IF  NOT  LESS
.
	 GOTO	   DETLOOP
............................................................
.
. 
HEADER	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
.
	 ADD	   "1",PAGES
	 PRINT	   *1,"*** PAGE	",PAGES," ***",*FLUSH
.
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
. 
. PRINTED  11 BLANK LINES FOR SPACE DOWN TO NEXT INVOICE
. 
	 MOVE	   "H" TO HDRSW
	 CALL	   PRNTS
	 MOVE	   " " TO HDRSW
	 RETURN
.
....................................................................
SETEOJ	 MOVE	   "X" TO EOJSW
NODETS	 COMPARE   "27",LINES
	 GOTO	   SPCLOOP IF LESS
	 GOTO	   SUBTOTS IF EQUAL
. 
SPCLOOP	 PRINT	   " ",*FLUSH
	 ADD	   "1" TO LINES
	 GOTO	   NODETS
. 
SUBTOTS	 ADD	   CALCNET TO LIBNET
.
	 PRINT	   " ",*FLUSH
	 PRINT	   " ",*FLUSH
.
	 CMATCH	   "C",COMPLET
	 GOTO	   PARTL IF NOT	EQUAL
.
	 PRINT	   *8,"ACCT. ",CUSTKEY:
		   *54,"X",*81,INVNET,*FLUSH
.
	 ADD	   CALCNET  TO	INVNET
.
	 ADD	   "3" TO LINES
	 GOTO	   GETADDR
.
PARTL	 PRINT	   *8,"ACCT. ",CUSTKEY:
		   *63,"X",*81,INVNET,*FLUSH
.
	 ADD	   CALCNET  TO	INVNET
.
	 ADD	   "3" TO LINES
.
GETADDR	 PRINT	   *82,CALCNET,*FLUSH
	 ADD	   "1" TO LINES
GTADR	 CALL	   ADRPRINT
.
P1	 PRINT	   " "
	 PRINT	   " "
	 PRINT	   " "
	 PRINT	   " "
	 PRINT	   " "
	 PRINT	   " "
	 PRINT	   " "
	 PRINT	   " "
.
	 PRINT	   " "
	 PRINT	   " "
	 PRINT	   " ",*FLUSH
.
	 MATCH	   "X" TO ALIGNSW
	 GOTO	   ALIGNRTN IF EQUAL
.
........................................................................
.  NOW ADD THE ACCOUNTS	RECEIVABLE RECORDS AND INDICES
........................................................................
.
	 MOVE	   "O"	TO  INVSTAT
	 CALL	   ADDINVC1
.
	 MOVE	   "00.00"  TO	INVNET
........................................................................
.  NOW UPDATE THE SOHDRFL RECORD INDICATING INVOICE HAS	BEEN PRINTED
........................................................................
.
	 MOVE	   "I"	TO  INVSTAT
.
	 INCLUDE   SOHDUPDT.TXT
.
.
	 CMATCH	   "X",EOJSW
	 GOTO	   LASTEOJ  IF	EQUAL
.
	 GOTO	   HDRLOOP
.
ALIGNRTN RETURN
.
................................................................
.  NOW ADD THE RECEIVABLES RECORD AND VARIOUS ACCESS INDICES   .
................................................................
.
ADDINVC1 MOVE	   INVNET  TO  INVTOTL
	 MOVE	   INVNET  TO  IDOLSLFT
 
	 INCLUDE   RCVBADD1.TXT
.
INVCRTRN RETURN
...................................................................
.
LASTEOJ	 BEEP
	 DISPLAY   *P1:23,*EL,"END OF INVOICE MAILER   R E P R I N T",*W2
.
	 RELEASE
	 CHAIN	   "APPMENU1"
.
	 STOP
.
	 INCLUDE   CONTRLIO
. 
	 INCLUDE   CUSTIO
. 
	 INCLUDE   STDIOERR
. 
	 INCLUDE   STDFMTER
. 
	 INCLUDE   STDRANGE
. 
	 INCLUDE   STDPARER
.
	 INCLUDE   RCVBLSIO
. 
	 STOP
