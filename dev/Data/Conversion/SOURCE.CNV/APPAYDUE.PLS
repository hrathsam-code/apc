.... APPAYDUE.DBC    PRINT A/P PAYMENTS DUE REPORT

	 INCLUDE   MSCBRAG.TXT
	 INC	   COMMON
	 INC	   APMASTFD
	 INC	   APTRANFD
APTRANFL IFILE	   KEYL=19,UNCOMPRESSED
APMASTER IFILE	   KEYL=6,UNCOMPRESSED
DESC	 DIM	   20
AMT	 FORM	   6.2
LDMON	 DIM	   2
LDS1	 DIM	   1
LDDAY	 DIM	   2
LDS2	 DIM	   1
LDYEAR	 DIM	   2
LINES	 FORM	   "50"
RMON	 DIM	   2
RDAY	 DIM	   2
RYEAR	 DIM	   2
TOT	 FORM	   8.2
KEY	 DIM	   13
RDATE	 DIM	   6
TDATE	 DIM	   6
PAGE	 FORM	   3
DATEDESC DIM	   15
DATERROR DIM	   1
MM DIM 2
DD DIM 2
YY DIM 2
FM FORM	2
FD FORM	2
FY FORM	2
BKUPFLG	 DIM	   1
DATFLG	 DIM	   1
REPLY	 DIM	   1
. 
APADJUST FILE
ADJUST	 FORM	   5.2
REC0	 FORM	   "00"
 
         INCLUDE   CALLERR1.INC
 
         MOVE      "A/P PAYABLES DUE REPORT"  TO  TITLTEXT
 
         INCLUDE   CALLER2.INC

. 
	 DISPLAY   *ES,*P01:10,*HON,"PRINT A/P PAYABLES	DUE REPORT"
	 OPEN	   APMASTER,"APMASTER.ISI"
	 OPEN	   APTRANFL,"APTRANFL.ISI"
A1	 MOVE	   "X",BKUPFLG
.
         CLOCK     DATE  TO TODAY
 
	 MOVE	   TODAY TO MM
         RESET     TODAY TO 4
	 MOVE	   TODAY TO DD
         RESET     TODAY TO 7
	 MOVE	   TODAY TO YY
	 REP	   " 0"	 IN MM
	 RESET	   TODAY TO 1
. 
	 MOVE	   MM TO RMON
	 MOVE	   DD TO RDAY
	 MOVE	   YY TO RYEAR
	 MOVE	   RYEAR TO RDATE
	 RESET	   RDATE,2
	 APPEND	   RMON	TO RDATE
	 APPEND	   RDAY,RDATE
	 RESET	   RDATE
	 MOVE	   "0000000000000000000",TRNKEY
	 INC	   APTRANRD
	 GOTO	   A1A IF NOT OVER
	 BEEP
	 DISPLAY   *P1:23,*HON,"NO HEADER ON TRANSACTION FILE",*W,*W,*W
	 CHAIN	   FROMPGM

A1A	 MATCH	   TRNKEY TO TRNKEY2
	 GOTO	   APTRANBK IF NOT EQUAL	 BAD INDEX FILE
.
A2	 TRAPCLR   PARITY
	 INC	   APTRANKS
	 GOTO	   EOJ IF OVER
	 RESET	   TLDDAY TO 8
	 LENSET	   TLDDAY
	 RESET	   TLDDAY TO 7
	 MOVE	   TLDDAY TO TDATE
	 RESET	   TDATE TO 2
	 RESET	   TLDDAY TO 2
	 LENSET	   TLDDAY 
	 RESET	   TLDDAY TO 1
	 APPEND	   TLDDAY TO TDATE
	 RESET	   TLDDAY TO 5
	 LENSET	   TLDDAY
	 RESET	   TLDDAY TO 4
	 APPEND	   TLDDAY TO TDATE
	 RESET	   TDATE TO 1
	 RESET	   TLDDAY TO 8
	 LENSET	   TLDDAY
	 RESET	   TLDDAY TO 1

	 MATCH	   TDATE,RDATE

	 GOTO	   A2A IF EQUAL
	 GOTO	   A2 IF LESS

A2A	 MOVE	   TACCN TO ACCKEY
	 INC	   APMASTRD
	 GOTO	   A3 IF NOT OVER
	 MOVE	   "			     ",NAME
A3	 CALL	   APMASTVK
	 COMPARE   "50",LINES
	 CALL	   HEADER IF NOT LESS
. 
.....	 PRINT	   *21,ACCNO,*33,NAME,*63,TINVNO," ",TCNT,*76,TLDDAY,*90,TAMT:
.....		   *102,TDISA
. 
	 REP	   " 0"	IN TMON
	 PRINT	   *21,ACCNO,*33,NAME,*63,TINVNO," ",TCNT,*76,TMON,"/":
		   TDAY,"/",TYEAR,*90,TAMT,*102,TDISA
. 
	 ADD	   "1",LINES
	 ADD	   TAMT,TOT
	 GOTO	   A2
HEADER	 ADD	   "1",PAGE
	 PRINT	   *F,*55,"PAYABLES DUE",*90,"PAGE ",PAGE
	 PRINT	   *54,"AS OF ",RMON,"/",RDAY,"/",RYEAR
	 PRINT	   " "
	 PRINT	   *21,"VENDOR",*43,"NAME",*64,"INVOICE",*77,"INVOICE":
		   *91,"AMOUNT",*102,"DISCOUNT"
. 
	 PRINT	   *79,"DATE"
. 
....	 PRINT	   " "
	 MOVE	   "0",LINES
	 RETURN
EOJ	 PRINT	   *88,"-----------"
. 
....	 OPEN	   APADJUST,"APADJUST"
....	 READ	   APADJUST,REC0;ADJUST
....	 ADD	   ADJUST TO TOT
. 
	 PRINT	   *88,TOT
	 CLOSE	   APTRANFL
	 CLOSE	   APMASTER
	 RELEASE
	 CHAIN	   FROMPGM

	 INC	   APTRANBK
	 INC	   GETDATE
	 INC	   APMASTVK
