


PAGE    1      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

PL/B COMPILER   Version 8.7E  06 Jan 2004 
COMMAND LINE WAS: PLBCMP F:\SOURCE.CNV\APPINVCS.PLS,F:\PLC\APPINVCS.PLC,F:\SOURCE.CNV\APPINVCS.LST -ZI,P,L 

    1.                                .   ORDER PROCESSING SYSTEM......INVOICE DATA ENTRY
    2.                                . 
    3.                                .  WRITTEN BY R. BACHARACH,  MICRO SYSTEMS CONSULTANTS
    4.                                .                            41 TEELE DRIVE
    5.                                .                            CORAM, NEW YORK 11727
    6.                                .                            (516) 698-5577
    7.                                . 
    8.                                         INCLUDE   COMMON.TXT
    8.    INCLUDE  A: f:\source.cnv\common.txt
    1. A                              *................................................................
    2. A                              . COMMON - DEFINE COMMON DATA AREAS
    3. A                              . 
    4. A                              . NOTE:  85 BYTES WILL BE RESERVED FOR INTER PROGRAM COMMUNICATIONS
    5. A                              . MODIFIED 3/15/80 FOR I/O FUNCTION TYPE LOAD FOR ERROR DETECTION
    6. A                              . 
    7. A    00000818                  PORTN    DIM       *30
    8. A    0000083E                  TODAY    DIM       *8                  DATE IN mm/dd/yy FORMAT
    9. A    0000084E                  SECURITY FORM      *1                  SECURITY CLEARANCE LEVEL
   10. A    00000854                  DATE6    DIM       *6                  DATE IN MMDDYY WITH NO /
   11. A    00000862                  ENVS     DIM       *4                  COMPANY LOCATOR - ENVIRONMENT
   12. A    0000086E                  PONUMBS  DIM       *4
   13. A    0000087A                  INVNUMB  DIM       *5                  CURRENT INVOICE NUMBER
   14. A    00000888                  ACCTNUMB DIM       *4                  CURRENT ACCOUNT NUMBER
   15. A    00000894                  VENDNUMB DIM       *3                  CURRENT VENDOR NUMBER
   16. A    000008A0                  FROMPGM  DIM       *8                  CALLING PROGRAM NAME
   17. A    000008B0                  FIRSTIME DIM       *1                  FIRST TIME SWITCH
   18. A    000008BA                  TESTONE  DIM       *1
   19. A    000008C4                  TESTTWO  DIM       *1
   20. A    000008CE                  TESTTHRE DIM       *1
   21. A    000008D8                  ERRORSW1 DIM       *1
   22. A    000008E2                  ERRORSW2 DIM       *1
   23. A    000008EC                  ERRORSW3 DIM       *1
   24. A    000008F6                  ERRORSW4 DIM       *1
   25. A    00000900                  USERLOCN DIM       *1
   26. A    0000090A                  IOTEST   DIM       *1
   27. A    00000914                  IOTYPE   DIM       *6                  READ/WRITE/UPDATE
   28. A    00000922                  IOERFILE DIM       *19                 NAME OF FILE TRAPPED FOR ERROR MSG
   29. A    0000093E                  USERCODE DIM       *9                  USER ID CODE
   30. A    00000950                  USERNAME DIM       *20                 USER'S NAME
   31. A    0000096C                  APPCODE  DIM       *2                  APPLICATION (A/R, A/P, O/P, etc)
   32. A    00000976                  APPSECUR FORM      *2                  USER'S SECURITY LEVEL FOR APPLICATION
   33. A                              . 
   34. A                              .  END OF COMMON WORK AREA FOR INTER PROGRAM COMMUNICATION
   35. A                              . 
    9.                                . 
   10.      0000097E                  PASSCUST DIM       30
   11.      000009A4                  INVCNUMB DIM        5
   12.      000009B2                  PASSDT6  DIM       6
   13.      000009C0                  PASSACCT DIM       4
   14.      000009CC                  PASSCOMP DIM       1



PAGE    2      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

   15.                                . 
   16.      000009D6                  NAME     INIT      "ARFILE.ISI"
   17.      000009E8                  OUTPUT   IFILE     KEYL=5,UNCOMPRESSED
   18.                                .
   19.      00000A10                  NEWFILE  IFILE     KEYL=5,UNCOMPRESSED
   20.      00000A38                  NEWFNAME INIT      "NEWINVCS.ISI"
   21.                                .
   22.      00000A4C                  NINVCNO  DIM       5
   23.      00000A5A                  NEWFKEY  DIM       5
   24.                                .
   25.      00000A68                  REPLY    DIM       1
   26.                                .FIELD   TYPE      LENGTH    FROM-TO   DESCRIPTION
   27.                                .-----   ----      ------    -------   -----------
   28.      00000A72                  WORK01   DIM        1
   29.      00000A7C                  WORK02   DIM        2
   30.      00000A86                  WORK03   DIM        3
   31.      00000A92                  WORK04   DIM        4
   32.      00000A9E                  WORK08   DIM        8
   33.      00000AAE                  WORK10   DIM       10
   34.      00000AC0                  WORK09   DIM       9
   35.      00000AD2                  FIELD09  DIM       7
   36.      00000AE1                  NFIELD09 FORM      7
   37.                                .
   38.      00000AEE                  DATE8    DIM       8            8 DIGIT DATE WORK FIELD
   39.      00000AFE                  MM       DIM       2
   40.      00000B08                  DD       DIM       2
   41.      00000B12                  YY       DIM       2
   42.      00000B1C                  XMM      DIM       2
   43.      00000B26                  XDD      DIM       2
   44.      00000B30                  XYY      DIM       2
   45.      00000B3A                  FORM5    FORM      5
   46.                                . 
   47.      00000B44                  DTYPE    DIM       8
   48.      00000B54                  DSTAT    DIM       10
   49.      00000B66                  INDX     FORM      2
   50.      00000B6E                  STARTKEY DIM       5
   51.      00000B7C                  PP       DIM       1
   52.      00000B86                  PC       DIM       1
   53.      00000B8F                  LINES    FORM      2
   54.      00000B96                  PTERMS   DIM       18
   55.      00000BB0                  HDRSW    DIM       1
   56.      00000BB9                  PAGES    FORM      2
   57.                                . 
   58.                                         INCLUDE   PART.TXT
   58.    INCLUDE  B: f:\source\part.txt
    1. B                              .
    2. B                              ................................................................
    3. B                              . PART/TXT INCLUDE MODULE
    4. B                              . 
    5. B    00000BC0                  PARTNO   DIM       7
    6. B    00000BD0                  PART3    DIM       3
    7. B    00000BDC                  PART4    DIM       4
    8. B    00000BE8                  PSIZE    DIM       15



PAGE    3      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

    9. B    00000C00                  PDESC    DIM       15
   10. B    00000C17                  FRGTRATE FORM      2.2
   11. B    00000C21                  KEGSORD  FORM      7
   12. B    00000C2D                  PCSORD   FORM      7
   13. B    00000C39                  USAGINDX FORM      1
   14. B    00000C3F                  LINEPRC  FORM      4.2
   15. B                              . ......................
   59.                                . 
   60.                                . CONTROL FILE AREA
   61.                                . 
   62.                                         INCLUDE   CONTFILE.TXT
   62.    INCLUDE  C: f:\source\contfile.txt
    1. C                              . 
    2. C                              . CONTROL FILE INCLUDE MODULE - SOURCE BOOK NAME: CONTFILE (VOLID=MSC 6)
    3. C                              . 
    4. C    00000C4C                  CONTROLS IFILE     KEYL=3,UNCOMPRESSED
    5. C    00000C74                  CTLNAME  INIT      "CONTROLS.ISI"
    6. C                              . 
    7. C                              . 
    8. C                              . CONTROL FILE I/O AREA FOR READ/UPDATE
    9. C                              . 
   10. C    00000C88                  CTLKEY   DIM       3       VALUES = "LIB" OR "REP"
   11. C    00000C94                  CTLDATE  DIM       8       DATE OF LAST UPDATE  MM/DD/YY
   12. C    00000CA4                  CTLINVC  FORM      5       LAST INVOICE NUMBER USED
   13. C    00000CAE                  CTLPONO  FORM      4       LAST PURCHASE ORDER NUMBER USED
   14. C    00000CB7                  CTLRCVD  FORM      7.2     DAILY INVENTORY DOLLARS RECEIVED
   15. C    00000CC6                  CTLSOLD  FORM      7.2     DAILY INVENTORY DOLLARS SOLD
   16. C    00000CD5                  CTLCASH  FORM      7.2     DAILY CASH RECEIVED/PROCESSED
   17. C    00000CE4                  CTLMRCVD FORM      7.2     M-T-D INVENTORY DOLLARS RECEIVED
   18. C    00000CF3                  CTLMSOLD FORM      7.2     M-T-D INVENTORY DOLLARS SOLD
   19. C    00000D02                  CTLMCASH FORM      7.2     M-T-D CASH RECEIVED/PROCESSED
   20. C    00000D11                  CTLYRCVD FORM      8.2     Y-T-D INVENTORY DOLLARS RECEIVED
   21. C    00000D21                  CTLYSOLD FORM      8.2     Y-T-D INVENTORY DOLLARS SOLD
   22. C    00000D31                  CTLYCASH FORM      8.2     Y-T-D CASH RECEIVED/PROCESSED
   23. C                              . 
   24. C                              .  END OF CONTROL RECORD I/O AREA
   25. C                              . 
   63.                                . 
   64.      00000D41                  NFIELD01 FORM       4                  (NUMERIC WORK FIELD)
   65.      00000D4A                  FIELD01  DIM        4
   66.                                . 
   67.      00000D56                  NFLD01   FORM      9
   68.      00000D64                  FLD01    DIM       9
   69.                                . 
   70.      00000D76                  MULTIFLG DIM       1
   71.      00000D7F                  MULTIROW FORM      2
   72.      00000D86                  MULTICNT FORM      2
   73.      00000D8E                  MULTIDSC DIM       25
   74.      00000DB0                  MD1      DIM       25
   75.      00000DD2                  MD2      DIM       25
   76.      00000DF4                  MD3      DIM       25
   77.      00000E16                  MD4      DIM       25
   78.      00000E38                  MD5      DIM       25



PAGE    4      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

   79.      00000E5A                  MD6      DIM       25
   80.      00000E7C                  MD7      DIM       25
   81.      00000E9E                  MD8      DIM       25
   82.      00000EC0                  MD9      DIM       25
   83.      00000EE2                  MD10     DIM       25
   84.      00000F04                  EXTRA    INIT      "XXXXXXXXXXXXXXXXXXX"
   85.      00000F20                  COMPLETE DIM       1
   86.      00000F2A                  UOM      DIM       2
   87.      00000F34                  PRODCODE DIM       2
   88.      00000F3E                  SHIPNAME DIM       30
   89.      00000F64                  SHIPADDR DIM       25
   90.      00000F86                  SHIPYADR DIM       25
   91.      00000FA8                  SHIPADR2 DIM       25
   92.      00000FCA                  SHIPCITY DIM       18
   93.      00000FE4                  SHIPSTAT DIM       2
   94.      00000FEE                  SHIPZIP  DIM       5
   95.      00000FFC                  COMPLET  DIM       1
   96.                                . 
   97.      00001006                  NORMTERM INIT      "2% 15 NET 30"
   98.      0000101A                  NEWTERM  DIM       15
   99.                                . ACCOUNT FILE READ/WORK AREA
  100.                                . 
  101.      00001034                  CUSTFILE IFILE     KEYL=4,UNCOMPRESSED
  102.      0000105C                  CSTNAME  INIT      "ACCOUNTS.ISI"
  103.                                . 
  104.                                         INCLUDE   CUSTMAST.TXT
  104.    INCLUDE  D: f:\source.cnv\custmast.txt
    1. D                              . 
    2. D                              . CUSTOMER MASTER FILE DEFINITION   SOURCE NAME CUSTMAST/TXT  9/29/79
    3. D                              . 
    4. D                              . RECORD LENGTH IS 225 BYTES: (INCLUDES AGEING CATEGORIES)
    5. D                              . 
    6. D                              . KEY LOCATED POSITION 1 FOR A LENGTH OF 4 BYTES
    7. D                              . 
    8. D    00001070                  CUSTKEY  DIM       4
    9. D    0000107C                  CUSTSTTS DIM       1         STATUS OF ACCT: A=OPEN, C=MODIFIED, D=DELETED
   10. D    00001086                  CUSTNAME DIM       30
   11. D    000010AC                  CUSTADDR DIM       25
   12. D    000010CE                  CUSTADR2 DIM       25
   13. D    000010F0                  CUSTCITY DIM       20
   14. D    0000110C                  CUSTSTAT DIM       2
   15. D    00001116                  CUSTZIP  FORM      5
   16. D    00001120                  CUSTCRED FORM      6         CREDIT LIMIT IN DOLLARS
   17. D    0000112C                  CUSTCATG DIM       1         PAYMENT CATEGORY: P=POOR, OTHERWISE OK
   18. D                              . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
   19. D                              .  MOST CURRENT SALES AND PAYMENT ACTIVITY         
   20. D                              .  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
   21. D    00001136                  LSTSALDT DIM       6         LAST SALE DATE
   22. D    00001144                  LSTPAYDT DIM       6         LAST PAYMENT DATE
   23. D    00001152                  LSTSALPR FORM      5.2       LAST INVOICE AMOUNT
   24. D    0000115F                  LSTPAYPR FORM      5.2       LAST PAYMENT AMOUNT
   25. D                              . ......................................................................
   26. D    0000116C                  COMMCODE DIM       4         COMMISSION CODE



PAGE    5      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

   27. D                              . ......................................................................
   28. D                              .  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
   29. D                              .  ACCOUNTS RECEIVABLES SYSTEM - AGEING CATEGORIES
   30. D                              .  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
   31. D    00001178                  CURNTDUE FORM      6.2       CURRENT DUE AMOUNT    (1-30 DAYS OLD)
   32. D    00001186                  PD01TO30 FORM      6.2       PAST DUE 1-30         (31-60 DAYS OLD)
   33. D    00001194                  PD31TO60 FORM      6.2       PAST DUE 31-60        (61-90 DAYS OLD)
   34. D    000011A2                  PD61TO90 FORM      6.2       PAST DUE 61-90        (91-120 DAYS OLD)
   35. D    000011B0                  PDOVR90  FORM      6.2       PAST DUE 91+          (121+   DAYS OLD)
   36. D                              .  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
   37. D                              .  MONTH TO DATE CASH PROCESSED AND CREDITS ISSUED TO ACCT
   38. D                              .  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
   39. D    000011BE                  MTDCASH  FORM      6.2
   40. D    000011CC                  MTDCRED  FORM      5.2
   41. D                              . 
   42. D                              ........TELEFONE DIM       12
   43. D                              .
   44. D                              . 
  105.                                .
  106.      000011DA                  CLOSESW  INIT      " "
  107.                                . 
  108.      000011E4                  PORTXX   DIM       12
  109.                                . 
  110.      000011F8                  ADDKEY   FORM      5           INCREMENT WORK FIELD FOR NUMBERS
  111.                                . 
  112.                                .  WORK  AREAS FOR INVOICE HEADER CREATION/WRITE
  113.                                . 
  114.                                         INCLUDE   RCVBLES.TXT
  114.    INCLUDE  E: f:\source\rcvbles.txt
    1. E                              .**********************************************************************
    2. E                              . 
    3. E                              . RECEIVABLES MASTER FILE DEFINITION:    MODULE NAME  "RCVBLES/TXT"
    4. E                              . 
    5. E                              .                 RECORD LENGTH IS 153 BYTES
    6. E                              . 
    7. E                              . ACTUAL FILE IS NAMED "ARFILEXX/ISAM" AND RESIDES ON "SUPERIORPR01" VOLUME
    8. E                              . 
    9. E                              . INDEX KEY IS INVOICE NUMBER WITHIN ACCOUNT NUMBER - 9-14,6,1-5
   10. E                              .**********************************************************************
   11. E                              . 
   12. E                              . 
   13. E    00001204                  RCVBFILE IFILE     KEYL=5,UNCOMPRESSED
   14. E    0000122C                  RCVBNAME INIT      "ARFILE.ISI"
   15. E                              . 
   16. E                              . 
   17. E    0000123E                  INVKEY   DIM       5
   18. E    0000124C                  INVTYPE  DIM       1          I=INVOICE,  C=CREDIT
   19. E    00001256                  INVCOMP  DIM       1
   20. E    00001260                  INVSTAT  DIM       1          STATUS: O=OPEN, P=PARTIAL, V=VOID, X=PAID
   21. E                              .                                     W=WRITEOFF
   22. E    0000126A                  INVCUST  DIM       4
   23. E    00001276                  INVDATE  DIM       6          MMDDYY
   24. E    00001284                  INVTOTL  FORM      6.2



PAGE    6      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

   25. E                              . 
   26. E    00001292                  IPMNTS   FORM      1          MAXIMUM OF 5 PAYMENTS
   27. E                              . 
   28. E    00001298                  IAMTPD1  FORM      6.2
   29. E    000012A6                  IAMTPD2  FORM      6.2
   30. E    000012B4                  IAMTPD3  FORM      6.2
   31. E    000012C2                  IAMTPD4  FORM      6.2
   32. E    000012D0                  IAMTPD5  FORM      6.2
   33. E                              . 
   34. E    000012DE                  ICHK1    DIM       6
   35. E    000012EC                  ICHK2    DIM       6
   36. E    000012FA                  ICHK3    DIM       6
   37. E    00001308                  ICHK4    DIM       6
   38. E    00001316                  ICHK5    DIM       6
   39. E                              . 
   40. E    00001324                  IDTPD1   DIM       6
   41. E    00001332                  IDTPD2   DIM       6
   42. E    00001340                  IDTPD3   DIM       6
   43. E    0000134E                  IDTPD4   DIM       6
   44. E    0000135C                  IDTPD5   DIM       6
   45. E                              . 
   46. E    0000136A                  IMATLS   FORM      6.2
   47. E                              . 
   48. E    00001378                  IDOLSLFT FORM      6.2       DOLLARS OUTSTANDING
   49. E    00001386                  IPRGDTE  DIM       8         PURGE DATE
   50. E                              . 
   51. E                              . ...............................................
   52. E                              . ADDITIONAL FIELDS FOR INVOICE DATA ENTRY
   53. E    00001396                  INVFOB   DIM       1
   54. E    000013A0                  INVMESG  DIM       10
   55. E    000013B2                  MOREORDR DIM       10
   56. E    000013C4                  INVORDNO DIM       14
   57. E    000013DA                  INVWGHT  FORM      4
   58. E    000013E3                  CARTONS  FORM      2
   59. E    000013EA                  INVSHIP  DIM       18
   60. E    00001404                  INVBLNO  DIM       1
   61. E    0000140E                  INVDTPAY DIM       1
   62. E    00001417                  IAMTRCVD FORM      1.1
   63. E    00001420                  INVCHECK DIM       6
   64. E                              . ...............................................
   65. E                              .   END OF RECEIVABLES RECORD
   66. E                              . 
  115.                                . 
  116.      0000142E                  SAVE     DIM         10
  117.      00001440                  TOTDOLS  FORM        6.2
  118.      0000144E                  FRGHT    FORM        2.2
  119.                                . 
  120.      00001458                  OLDDET   DIM       1
  121.      00001462                  IOSW     DIM       1
  122.      0000146B                  LIBNET   FORM      7.2
  123.      0000147A                  REPNET   FORM      7.2
  124.                                . 



PAGE    7      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  125.                                +...........................................................
  126.                                . 
  127.      0000148A                  DATE2X   DIM       2
  128.      00001494                  DATE2N   FORM      2
  129.                                . 
  130.                                . 
  131.      0000149B                  INVCKEGS FORM      7     (ORDER QTY)
  132.      000014A7                  PCSSOLD  FORM      7     (SHIPPED QTY)
  133.      000014B3                  INVPCSKG FORM      7     (BACKORDER QTY)
  134.                                . 
  135.      000014C0                  BUILDPT  DIM       7
  136.                                . 
  137.                                . RECORD ASSEMBLY AREA
  138.                                .           INVOICE DETAIL DETAIL RECORD = 45 BYTES
  139.                                . 
  140.      000014D0                  INVCNO   DIM       5                   INVC NUMBER
  141.      000014DE                  INVCLINE DIM       2                   INVC LINE NUMBER SUFFIX FOR INDEXING
  142.                                . 
  143.                                .  NOTE THAT INVCLINE WILL BE A 2 DIGIT NUMERIC SUFFIX
  144.                                .  COUNTER-CREATED IN THIS PROGRAM
  145.                                . 
  146.      000014E8                  INVLINES FORM      "00"
  147.      000014EF                  IRECCNTR FORM      6
  148.      000014FA                  DTLSTAT  DIM       1
  149.      00001503                  ILIVCNTR FORM      3
  150.                                . 
  151.      0000150B                  ROW      FORM      2                USED TO ROLL DOWN THE KEYIN STMT
  152.                                . 
  153.      00001512                  NFIELD04 FORM       5.2                (NUMERIC WORK FIELD)
  154.      00001520                  FIELD04  DIM        8         11- 18   PRICE LN 1                 5.2
  155.      00001530                  NFIELD03 FORM       3
  156.      00001538                  FIELD03  DIM        3
  157.      00001543                  NFIELD02 FORM       4
  158.      0000154C                  FIELD02  DIM        4
  159.                                . 
  160.                                . EXTENSION CALCULATE WORK/DISPLAY AREA
  161.                                . 
  162.      00001558                  LNDOLS   FORM      5.2
  163.      00001565                  KEGQTY   FORM      9
  164.      00001573                  LINECOST FORM      6.2
  165.      00001581                  KGSAVAIL FORM      6
  166.      0000158C                  CRAPMSG  DIM       18
  167.      000015A6                  CALCFLD  FORM      8.3
  168.      000015B7                  OLDFRGT  FORM      5.2
  169.                                . 
  170.      000015C4                  FILLER   INIT      "........./........./........./........"
  171.      000015F2                  FILLER2  INIT      "..............."
  172.                                .
  173.      00001609                  FORM3    FORM      3
  174.      00001612                  IPNSTDSX DIM       6
  175.      00001620                  IPNSTDSN FORM      6
  176.      0000162C                  NONSTDSW DIM       1
  177.      00001636                  SCANSW   DIM       1



PAGE    8      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  178.      00001640                  PARTUPSW DIM       1
  179.                                . 
  180.      0000164A                  KREPLY   DIM       1
  181.                                . 
  182.      00001654                  CHKPASS  DIM       5
  183.                                .  
  184.      00001661                  WEIGHT   FORM      6
  185.      0000166C                  HDRCHGSW DIM       1
  186.                                . 
  187.      00001676                  INVDTKEY DIM       7
  188.                                . 
  189.      00001685                  OLDXTEND FORM      6.2
  190.                                . 
  191.                                . 
  192.      00001693                  CALCNET  FORM      6.2
  193.      000016A1                  FRTALLOW FORM      5.2
  194.                                . 
  195.                                . NEW DIRECT-ACCESS FILE ADDED HERE TO ALLOW WRITING THE ENTIRE INVOICE
  196.                                . TO ONE FILE FOR BALANCING AND REVIEW/CORRECTION MODE
  197.                                . 
  198.      000016AE                  TIMEDIM  DIM       8
  199.      000016C0                  DAFILE   FILE      FIX=128,UNCOMPRESSED
  200.      000016E8                  DANAME   INIT      "DAFILE.TXT"
  201.                                . 
  202.      000016FA                  DARECNO  FORM      "0000"
  203.      00001703                  REC0     FORM      "0000"
  204.      0000170C                  REC1     FORM      "0001"
  205.      00001715                  REC2     FORM      "0002"
  206.      0000171E                  RECZERO  FORM      "0000"
  207.      00001727                  RECCNTR  FORM      4
  208.      00001730                  RECLIMIT FORM      "0099"
  209.      00001739                  CUSTN    FORM      4
  210.      00001742                  SPECMSG  DIM       80
  211.      0000179A                  MSGFLAG  DIM       1
  212.      000017A4                  PORTX    DIM       2
  213.      000017AE                  SPECSW   DIM       1
  214.      000017B8                  TIME     INIT      "HH/MM/SS"
  215.                                . 
  216.      000017C8                  SEQ      FORM      "-1"
  217.                                . 
  218.      000017D0                  INSERTFL IFILE      KEYL=10,UNCOMPRESSED
  219.      000017F8                  INSERTNM INIT      "ARFILEXX.ISI"   (KEY        IS ACCT,INVTYPE,INVC#)
  220.      0000180C                  INSERTKY DIM       10
  221.                                . 
  222.      00001820                  ARFILEDT IFILE     KEYL=11,UNCOMPRESSED
  223.      00001848                  ARFLDTNM INIT      "ARFILEDT.ISI"
  224.      0000185C                  ARFLDTKY DIM       11
  225.                                . 
  226.                                . 



PAGE    9      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  227.                                +........................................................................
  228.                                 
  229.                                         INCLUDE   CALLERR1.INC
  229.    INCLUDE  F: f:\source.cnv\callerr1.inc
    1. F                              .
    2. F                              .  CALLERR1  ERROR RETURN MODULE:  PLACE AT BEGINNING OF ALL PROGRAMS
    3. F                              .
    4. F                              .  3-10-2004 R. BACHARACH
    5. F                              .
    6. F                              .  PLACE THIS CODE AS LAST DATA AREA STATEMENTS
    7. F                               
    8. F                              .
    9. F    00001870                  TITLTEXT DIM       35
   10. F                               
   11. F    0000189B                  RESULT   FORM      4
   12. F    000018A4                  D        DIALOG 
   13. F    000018B4                  DDATA    INIT      "FONTSIZE=8,POS=5:5,SIZE=45:9,":
   14. F                                                 "TYPE=MODELESS,":
   15. F                                                 "TEXT=3:5:5:40:'IF YOU HAVE COME HERE ERRONEOUSLY ":
   16. F                                                 "FROM THE SYSTEM MENUS":
   17. F                                                 " AND DO NOT WANT TO RUN THIS PROGRAM, ":
   18. F                                                 "YOU MAY EXIT BY":
   19. F                                                 " CLICKING THE Quit BUTTON... ":
   20. F                                                 "OTHERWISE, CLICK Continue',":
   21. F                                                 "BUTTON=7:8:14:20:'&Continue',": 
   22. F                                                 "BUTTON=7:8:26:32:'&Quit'" 
   23. F                              .
   24. F                              .......................................................................
   25. F                              .
   26. F                                
  230.                                 
  231.      00000000                           MOVE      "ENTER AND PRINT INVOICES" TO TITLTEXT
  232.                                 
  233.                                         INCLUDE   CALLERR2.INC
  233.    INCLUDE  G: f:\source.cnv\callerr2.inc
    1. G                              .
    2. G                              .  CALLERR2  ERROR RETURN MODULE:  PLACE AT BEGINNING OF ALL PROGRAMS
    3. G                              .
    4. G                              .  3-10-2004 R. BACHARACH
    5. G                              .
    6. G                              .  BEGIN BY LOADING A PROGRAM TITLE INTO DIM FIELD "TITLTEXT"
    7. G                              .



PAGE   10      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

    8. G                              +........................................................................
    9. G                              .
   10. G                              .     (  MOVE      SOMENAME  TO  TITLTEXT  )
   11. G                              .
   12. G    0000000A                           SETMODE   *LTGRAY=ON,*3D=ON 
   13. G    00000010                           CREATE    D,DDATA
   14. G    0000001A                           DISPLAY   *BGCOLOR=*YELLOW,*ES,*BLUE:
   15. G                                                 *HON,*P05:01,TITLTEXT,*HOFF,*BLACK
   16. G    00000020                           ACTIVATE  D,TESTIT,RESULT
   17. G  1 0000002E                           LOOP 
   18. G  1 0000002E                           WAITEVENT 
   19. G  1 00000030                           REPEAT 
   20. G    00000036                           STOP 
   21. G                              .
   22. G    00000038                  TESTIT   BRANCH    RESULT OF NULL,MAINLINE,INDXIT
   23. G                              .
   24. G    00000046                  NULL     RETURN 
   25. G                              .
   26. G    00000048                  INDXIT   DISPLAY   *ES,*BLUE
   27. G    0000004E                           BEEP 
   28. G    00000054                           CHAIN     FROMPGM
   29. G                              . 
   30. G    0000005A                  MAINLINE MOVE      " ",REPLY
   31. G    00000064                           DEACTIVATE D
   32. G    0000006A                           DISPLAY   *BLUE
   33. G                              .
   34. G                              .......................................................................
  234.                                 
  235.                                . 
  236.      00000070                  START    DISPLAY   *ES,*P01:12,*HON,"INVOICE/CREDIT DATA ENTRY PROGRAM":
  237.                                                   *HOFF:
  238.                                                       *P01:14,"IF YOU HAVE COME HERE ERRONEOUSLY FROM THE ":
  239.                                                               "SYSTEM MENU PROGRAMS":
  240.                                                       *P01:15,"AND DO  N O T  HAVE ANY  INVOICES TO ":
  241.                                                               "ENTER........":
  242.                                                       *P01:17,"YOU MAY TERMINATE THIS PROGRAM BY PRESSING ":
  243.                                                               "THE   F5   KEY"
  244.      00000076                           KEYIN     *P01:20,*HON,"KEY     F5     TO  TERMINATE":
  245.                                                   *P01:21,"KEY     ENTER  TO  ADD INVOICES/CREDITS ",REPLY:
  246.                                                   *HOFF
  247.                                . 
  248.      0000007C                           GOTO      MAINLIN1  IF  NOT  F5
  249.                                . 
  250.      00000086                           BEEP 
  251.      0000008C                  INDXITS  DISPLAY   *HOFF,*ES
  252.      00000092                           BEEP 
  253.      00000098                           CHAIN     "APPINVC1"
  254.                                .
  255.      0000009E                  MAINLIN1 MOVE      " " TO REPLY
  256.                                .
  257.                                .
  258.      000000A8                           CLOCK     DATE  TO  TODAY
  259.      000000B2                           KEYIN     *ES,*P1:4,*HON,"I N V O I C E   P R O C E S S I N G":



PAGE   11      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  260.                                                       *P1:6,"ALIGN THE   T O P  OF THE PRINTER RIBBON ":
  261.                                                             "CARTRIDGE":
  262.                                                       *P1:8,"E V E N  WITH THE INVOICE PERFORATION ":
  263.                                                       *P1:10,"PRESS   (F3)   WHEN READY ",REPLY,*HOFF
  264.      000000B8                           GOTO      MAINLINE IF NOT F3
  265.                                . 
  266.      000000C2                  MAINLIN2 DISPLAY   *HOFF,*ES,*P01:01,"PREPARING DATA FILES FOR ENTRY"
  267.      000000C8                           MOVE      " ",REPLY
  268.      000000D2                           MOVE      " ",MSGFLAG
  269.      000000DC                           MOVE      " ",SPECMSG
  270.      000000E6                           GOTO      OPENFLS
  271.                                . 
  272.                                . 
  273.      000000EC                  MESSAGES KEYIN     *ES,*P01:02,*HON,"WOULD YOU LIKE A SPECIAL MESSAGE TO AP":
  274.                                                               "PEAR":
  275.                                                       *P01:03," IN THE BODY OF ALL INVOICES TODAY ?   ":
  276.                                                       " (Y/N)  ",REPLY,*HOFF
  277.      000000F2                           CMATCH    "N",REPLY
  278.      000000FC                           GOTO      OPENFLS IF EQUAL
  279.      00000102                           CMATCH    "Y",REPLY
  280.      0000010C                           GOTO      GIMMEMSG IF EQUAL
  281.      00000112                           BEEP 
  282.      00000118                           MOVE      " ",REPLY
  283.      00000122                           GOTO      MESSAGES
  284.                                . 
  285.      00000128                  GIMMEMSG DISPLAY   *P01:05,"PLEASE ENTER  T O D A Y `S  SPECIAL MESSAGE ":
  286.                                                           "BELOW  (FREE FORM TO 80 CHARACTERS)"
  287.      0000012E                           KEYIN     *P01:07,SPECMSG
  288.      00000134                           MOVE      "Y",MSGFLAG
  289.      0000013E                           DISPLAY   *P01:09,"YOUR MESSAGE IS:",*P01:10,SPECMSG
  290.      00000144                           MOVE      " ",REPLY
  291.      0000014E                           KEYIN     *P01:11,"IS THAT WHAT YOU WANT ?  (Y/N) ",REPLY
  292.      00000154                           CMATCH    "Y",REPLY
  293.      0000015E                           GOTO      OPENFLS IF EQUAL
  294.      00000164                           CMATCH    "N",REPLY
  295.      0000016E                           GOTO      MESSAGES IF EQUAL
  296.      00000174                           BEEP 
  297.      0000017A                           GOTO      MESSAGES
  298.                                . 
  299.                                . FILE OPENING SEQUENCE
  300.      00000180                  OPENFLS 
  301.                                ...        DISPLAY   *P1:23,*EL,"OPENING DAFILE.TXT",*W3
  302.                                 
  303.                                ...        TRAP      NOFILE  IF IO
  304.                                ...        PREPARE   DAFILE,DANAME
  305.                                 
  306.      00000180                           DISPLAY   *P1:23,*EL,"OPENING ARFILE.ISI",*W
  307.      00000186                           OPEN      OUTPUT,NAME
  308.                                 
  309.      00000194                           DISPLAY   *P1:23,*EL,"OPENING ARFILE.ISI",*W
  310.      0000019A                           CALL      OPENRCVB
  311.                                .
  312.      000001A0                           DISPLAY   *P1:23,*EL,"OPENING ARFILEXX.ISI",*W



PAGE   12      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  313.      000001A6                           OPEN      INSERTFL,INSERTNM
  314.                                .
  315.      000001B4                           DISPLAY   *P1:23,*EL,"OPENING ARFILEDT.ISI",*W
  316.      000001BA                           OPEN      ARFILEDT,ARFLDTNM
  317.                                 
  318.      000001C8                           DISPLAY    *P1:23,*EL,"OPENING NEWINVCS.ISI",*W,*P1:23,*EL
  319.      000001CE                           OPEN      NEWFILE,NEWFNAME
  320.                                 
  321.      000001DC                           DISPLAY   *P1:23,*EL,"ALL A/R FILES OPEN ",*W2,*P1:23,*EL
  322.                                .
  323.                                 
  324.                                . 
  325.      000001E2                           MOVE      TODAY TO MM
  326.      000001EC                           MOVE      TODAY TO XMM
  327.      000001F6                           RESET     TODAY TO 4
  328.      00000200                           MOVE      TODAY TO DD
  329.      0000020A                           MOVE      TODAY TO XDD
  330.      00000214                           RESET     TODAY TO 7
  331.      0000021E                           MOVE      TODAY TO YY
  332.      00000228                           MOVE      TODAY TO XYY
  333.      00000232                           RESET     TODAY TO 1
  334.                                 
  335.      0000023C                           REP       " 0"  IN XMM
  336.      00000246                           REP       " 0"  IN XDD
  337.      00000250                           REP       " 0"  IN XYY
  338.                                . 
  339.                                . SET UP SIX DIGIT DATE
  340.                                .
  341.      0000025A                           DISPLAY   *P1:23,*EL,"TODAY=",TODAY,*W
  342.                                 
  343.      00000260                           MOVE      TODAY TO DATE8
  344.                                 
  345.      0000026A                           MOVE      "000000"  TO  PASSDT6
  346.      00000274                           CLEAR     PASSDT6
  347.      0000027A                           APPEND    XMM  TO  PASSDT6
  348.      00000284                           APPEND    XDD  TO  PASSDT6
  349.      0000028E                           APPEND    XYY  TO  PASSDT6
  350.      00000298                           RESET     PASSDT6  TO  1
  351.      000002A2                           MOVE      PASSDT6  TO  INVDATE
  352.                                 
  353.      000002AC                           GOTO      ACCTOPEN
  354.                                .
  355.      000002B2                  NOFILE   DISPLAY   *ES,"INVOICE FILES NOT ON LINE":
  356.                                                   *N,"JOB IS ABORTING"
  357.      000002B8                           BEEP 
  358.      000002BE                           CHAIN     "APPINVC1"        GO BACK TO DISPLAY INVOICE MENU



PAGE   13      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  359.                                *...........................................................
  360.                                . OPEN ISAM-LOOKUP FILE
  361.                                .
  362.      000002C4                  ACCTOPEN TRAPCLR   IO
  363.      000002CA                           TRAP      NOCUSTFL IF IO
  364.      000002D8                           CALL      OPENCUST
  365.      000002DE                           CMATCH    "H"  TO  IOSW
  366.      000002E8                           GOTO      NOCUSTFL IF NOT EQUAL
  367.      000002EE                           TRAPCLR   IO
  368.      000002F4                           TRAP      NOCTRLS IF IO
  369.      00000302                           CALL      OPENCTLS
  370.      00000308                           CMATCH    "H"    TO IOSW
  371.      00000312                           GOTO      NOCTRLS IF NOT EQUAL
  372.      00000318                           TRAPCLR   IO
  373.                                . 
  374.                                . NOTE OPEN STATEMENTS BELOW WILL BE REQUIRED IF INVENTORY SYSTEM 
  375.                                . IS EVER INVOKED BY CLIENT
  376.                                . 
  377.                                ........ TRAP      NODETS  IF  IO
  378.                                ........ OPEN      OUTPUT2,INVDTLF    (OPEN THE DETAIL FILE ISAM)
  379.                                ........ INCLUDE   OPENPART
  380.                                ........ CALL      OPENCOMM
  381.                                ........ CALL      USAGOPEN
  382.                                . 
  383.                                . ........................................................................
  384.                                . NOW SET UP TO EITHER OPEN OR PREPARE A NEW DATA ENTRY BATCH FILE
  385.                                . WHOSE NAME IS IN THE FORM OF DAINVC##/TXT:NCLACCTS, WHERE ## IS A
  386.                                . REPLACED BY THE PORT NUMBER (HIGH ORDER ZERO FILLED) IN ORDER TO PERMIT
  387.                                . BOTH TERMINALS TO DO DATA ENTRY
  388.                                . 
  389.                                . ........................................................................
  390.                                . 
  391.                                .
  392.      0000031E                  PREPDA   CLOCK     TIME  TO  TIMEDIM
  393.      00000328                           PREPARE   DAFILE,DANAME
  394.                                .
  395.      00000336                  ZERONETS TRAPCLR   IO                (OKAY NOW LETS GO!)
  396.      0000033C                           MOVE      "A" TO INVCOMP
  397.      00000346                           GOTO      WHATKIND
  398.                                . 
  399.      0000034C                  NOCTRLS  DISPLAY   *ES," CONTROLS  FILE IS NOT ON-LINE",*W,*W
  400.      00000352                           BEEP 
  401.                                . 
  402.      00000358                  MNUCHAIN CHAIN     "APPINVC1"
  403.                                . 
  404.      0000035E                  NOCUSTFL DISPLAY   *ES,"INVENTORY FILE IS NOT ON-LINE, ABORTING"
  405.      00000364                           BEEP 
  406.      0000036A                           GOTO      MNUCHAIN
  407.                                . 
  408.                                . INSURE THAT ONLY A SECURITY "9" PERSON   
  409.                                .        (AND THAT`S ONLY THE AUTHOR)
  410.                                . CAN ENTER MANUAL INVOICE NUMBERS!
  411.                                . 



PAGE   14      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  412.      00000370                  WHATKIND COMPARE   "9" TO  SECURITY
  413.      0000037A                           GOTO      NEWONES  ( IF NOT EQUAL )
  414.                                . 
  415.      00000380                           KEYIN     *ES,*P01:12,"ARE YOU ENTERING OLD INVOICES? ":
                                                    *WARNING*
Warning: Statement has no label and follows unconditional goto.
  416.                                                               " Y or N ",REPLY
  417.      00000386                           CMATCH    "Y" TO REPLY
  418.      00000390                           GOTO      OLDONES IF EQUAL
  419.      00000396                           CMATCH    "N" TO REPLY
  420.      000003A0                           GOTO      NEWONES IF EQUAL
  421.      000003A6                           BEEP 
  422.      000003AC                           GOTO      WHATKIND
  423.      000003B2                  OLDONES  KEYIN     *P01:12,*EL,"SINCE THESE ARE OLD INVOICES YOU MUST ":
  424.                                                   "ENTER THEIR NUMBER AND DATE - (hit enter)",REPLY
  425.      000003B8                           MOVE      "O" TO TESTONE
  426.      000003C2                           GOTO      DISPLAY
  427.      000003C8                  NEWONES  KEYIN     *P01:12,*HON,*EL,"COMPUTER WILL ASSIGN INVOICE NUMBER  ":
  428.                                                           "(tap enter)",REPLY,*HOFF
  429.      000003CE                           MOVE      "N" TO TESTONE
  430.                                *...........................................................
  431.                                . INITIAL SCREEN DISPLAY SEQUENCE
  432.                                .
  433.      000003D8                  DISPLAY  CLOCK     TIME TO TIME
  434.                                . 
  435.      000003E2                           DISPLAY   *ES,*HON,*P11:1,"I N V O I C E / C R E D I T   D A T A":
  436.                                                   "   E N T R Y     ":
  437.                                                   *HOFF:
  438.                                                   *P11:2,"(I)nvoice or (C)redit?  I       ":
  439.                                                   *P43:2,"Document Number A_____":
  440.                                                   *P1:3,"Sold to  ",*P43:3,"Ship to ":
  441.                                                   *P1:4,"Acct No",*P3:5,"____":
  442.                                                   *HOFF:
  443.                                                   *P11:7,"P.O. ______________":
  444.                                                   *P51:7,"P.O.               ":
  445.                                                   *HON:
  446.                                                   *P1:8,"PO NUMBER      SHIPPED  WGHT CTNS  SHIP VIA":
  447.                                                    "            ":
  448.                                                   *P54:8,"TERMS            ",*P71:8,"COMP/PART",*HOFF
  449.      000003E8                  LOOP     TRAPCLR   PARITY       (NOP)
  450.                                . 
  451.      000003EE                  ORDERFOR MOVE      "A" TO INVCOMP
  452.      000003F8                           GOTO      K01
  453.                                . 
  454.      000003FE                  MOVREP   MOVE      "APP" TO CTLKEY
  455.      00000408                           GOTO      K01K
  456.                                . 



PAGE   15      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  457.                                *...........................................................
  458.                                . 
  459.                                .  SET NORMAL INVOICE CONSTANTS PRIOR TO DATA ENTRY
  460.                                . 
  461.                                ............................................................
  462.      0000040E                  K01      MOVE      "O"  TO  INVSTAT
  463.      00000418                           MOVE      INVCOMP  TO  PASSCOMP
  464.      00000422                           MOVE      "I"  TO  INVTYPE
  465.      0000042C                           MOVE      "C"  TO  INVFOB
  466.      00000436                           MOVE      " "  TO  INVCHECK
  467.      00000440                           MOVE      " "  TO  INVMESG
  468.      0000044A                           CLEAR     INVORDNO
  469.      00000450                           MOVE      " "  TO  MOREORDR
  470.      0000045A                           MOVE      "UPS          "  TO  INVSHIP
  471.      00000464                           DISPLAY   *P36:9,INVSHIP
  472.      0000046A                           MOVE      "0"      TO   INVWGHT
  473.      00000474                           MOVE      "0"      TO   CARTONS
  474.      0000047E                           MOVE      "000000.00"   TO   INVTOTL
  475.      00000488                           MOVE      "000000.00"   TO   IAMTRCVD
  476.      00000492                           MOVE      "0.00" TO LINEPRC
  477.      0000049C                           MOVE      "0.00" TO LINECOST
  478.      000004A6                           MOVE      "0.00" TO LNDOLS
  479.      000004B0                           MOVE      "C"      TO   COMPLET
  480.      000004BA                           DISPLAY   *P73:9,"(",COMPLET,")"
  481.                                . KEYIN VARIABLES SEQUENCE
  482.                                . 
  483.      000004C0                  INVTYPE  DISPLAY   *P35:2,INVTYPE
  484.      000004C6                           KEYIN     *P35:2,*RV,INVTYPE
  485.      000004CC                           CMATCH    "I" TO INVTYPE
  486.      000004D6                           GOTO      K01KA  IF EQUAL
  487.      000004DC                           CMATCH    "C" TO INVTYPE
  488.      000004E6                           GOTO      K01KA  IF EQUAL
  489.      000004EC                           BEEP 
  490.      000004F2                           MOVE      " " TO INVTYPE
  491.      000004FC                           GOTO      INVTYPE
  492.                                .
  493.                                *...........................................................
  494.                                . ACCOUNT ID NUMBER
  495.                                . THIS FIELD IS "BOTH" REQUIRED & FILL-CONTROLLED
  496.                                . FIELD TYPE IS NUMERIC
  497.                                . FIELD VALIDATION TYPE IS ISAM-VERIFICATION
  498.                                .
  499.                                . 
  500.      00000502                  K01KA    MOVE      INVCOMP TO PASSCOMP
  501.      0000050C                           MOVE      "APP" TO CTLKEY
  502.      00000516                           CMATCH    "A" TO INVCOMP
  503.      00000520                           GOTO      MOVREP IF EQUAL
  504.      00000526                  K01K     KEYIN     *P3:5,"____":
  505.                                                   *P3:5,*DE,WORK04
  506.      0000052C                           CMATCH    " " TO WORK04
  507.      00000536                           GOTO      K01K IF EOS
  508.      0000053C                  K01A     CLEAR     INVCUST
  509.      00000542                           MOVE      WORK04 TO INVCUST



PAGE   16      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  510.      0000054C                  K01B     RESET     INVCUST TO  4      (FILL-CONTROLLED)
  511.      00000556                           GOTO      K01K IF EOS
  512.      0000055C                           RESET     INVCUST
  513.      00000566                           MOVE      INVCUST TO CUSTKEY
  514.      00000570                  K01C     DISPLAY   *P3:5,INVCUST
  515.      00000576                           CALL      GETCUST
  516.      0000057C                           CMATCH    "H"  TO  IOSW
  517.      00000586                           GOTO      VCUST    IF  EQUAL
  518.      0000058C                           BEEP 
  519.      00000592                           DISPLAY   *P10:23,"INVALID ACCOUNT NUMBER - PLEASE RETRY ",*W,*W:
  520.                                                   *P10:23,*EL
  521.      00000598                           GOTO      K01K
  522.                                . 
  523.                                .  NOW DISPLAY THE VENDOR DATA FOR THE OPERATOR
  524.                                . 
  525.      0000059E                  VCUST    MOVE      CUSTKEY TO CUSTN
  526.                                . 
  527.      000005A8                  OKAYCOMP DISPLAY   *P11:3,CUSTNAME:
  528.                                                   *P11:4,CUSTADDR:
  529.                                                   *P11:5,CUSTCITY,*P32:5,CUSTSTAT,*P35:5,CUSTZIP
  530.                                . 
  531.      000005AE                           MOVE      CUSTNAME TO SHIPNAME
  532.      000005B8                           MOVE      CUSTADDR TO SHIPADDR
  533.      000005C2                           MOVE      CUSTCITY TO SHIPCITY
  534.      000005CC                           MOVE      CUSTSTAT TO SHIPSTAT
  535.      000005D6                           MOVE      CUSTZIP  TO SHIPZIP
  536.      000005E0                           MOVE      "                         " TO SHIPADR2
  537.      000005EA                           REP       " 0" IN SHIPZIP
  538.                                . 
  539.                                . NOW DISPLAY THE SHIP-TO DATA
  540.                                . 
  541.      000005F4                           DISPLAY   *P51:3,SHIPNAME:
  542.                                                   *P51:4,SHIPADDR:
  543.                                                   *P51:5,SHIPADR2:
  544.                                                   *P51:6,SHIPCITY:
  545.                                                   *P72:6,SHIPSTAT:
  546.                                                   *P75:6,SHIPZIP
  547.                                . 
  548.      000005FA                           CMATCH    "D",CUSTSTTS
  549.      00000604                           GOTO      DISPDELT IF EQUAL
  550.                                . 
  551.      0000060A                  ASKCUST  KEYIN     *P01:23,*EL,"CORRECT ACCOUNT ?  (Y/N) ",REPLY
  552.      00000610                           CMATCH    "Y",REPLY
  553.      0000061A                           GOTO      PASSNAME  IF  EQUAL
  554.      00000620                           BEEP 
  555.      00000626                           DISPLAY   *P01:23,*EL
  556.      0000062C                           GOTO      K01K
  557.                                . 
  558.      00000632                  INCOMPAT BEEP 
  559.      00000638                           DISPLAY   *ES,*P01:12,"ACCOUNT ",CUSTKEY," DOES NOT BELONG TO ":
  560.                                                               "COMPANY ",CTLKEY:
  561.                                                       *P01:14,"..CORRECT YOUR ERROR PLEASE! ",*W5
  562.      0000063E                           BEEP 



PAGE   17      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  563.      00000644                           GOTO      DISPLAY        (BACK TO ORDERFOR ENTRY!)
  564.                                . 
  565.      0000064A                  DISPDELT BEEP 
  566.      00000650                           DISPLAY   *ES,*P01:12,"THAT ACCOUNT IS DELETED/INACTIVE!":
  567.                                                   *N,"YOU MAY NOT INVOICE HIM UNTIL YOU UPDATE HIS ":
  568.                                                     "CUSTOMER MASTER RECORD",*W,*W
  569.      00000656                           CHAIN     "APPINVC1"
  570.                                . 
  571.      0000065C                  PASSNAME MOVE      CUSTNAME TO PASSCUST
  572.      00000666                           MOVE      CUSTKEY  TO PASSACCT   PASS THE ACCT NO. FOR $ UPDATE
  573.                                * ***********************************
  574.                                . 
  575.                                . NOW ALLOW CHANGES TO SHIP-TO DATA
  576.                                . 
  577.      00000670                           KEYIN     *P51:3,*RV,SHIPNAME
  578.      00000676                           DISPLAY   *P51:3,SHIPNAME
  579.                                . 
  580.      0000067C                           CLEAR     SHIPYADR
  581.      00000682                           KEYIN     *P51:4,SHIPYADR
  582.      00000688                           RESET     SHIPYADR
  583.      00000692                           GOTO      K03 IF EOS
  584.      00000698                           MOVE      SHIPYADR TO SHIPADDR
  585.      000006A2                           DISPLAY   *P51:4,SHIPADDR
  586.      000006A8                           KEYIN     *P51:5,*RV,SHIPADR2
  587.      000006AE                           DISPLAY   *P51:5,SHIPADR2
  588.      000006B4                           KEYIN     *P51:6,*RV,SHIPCITY
  589.      000006BA                           DISPLAY   *P51:6,SHIPCITY
  590.      000006C0                           KEYIN     *P72:6,*RV,SHIPSTAT
  591.      000006C6                           DISPLAY   *P72:6,SHIPSTAT
  592.      000006CC                           KEYIN     *P75:6,*RV,SHIPZIP
  593.      000006D2                           DISPLAY   *P75:6,SHIPZIP
  594.                                * ************************************
  595.      000006D8                  K03      DISPLAY   *P01:23,*EL
  596.                                *...........................................................
  597.                                . CUSTOMER ORDER NUMBER
  598.                                . NO EDITING WILL BE PERFORMED ON THIS FIELD
  599.                                .
  600.      000006DE                           TRAPCLR   PARITY
  601.      000006E4                  K03K     KEYIN     *P16:7,"______________":
  602.                                                   *P16:7,INVORDNO
  603.                                . 
  604.      000006EA                           RESET     INVORDNO TO 1
  605.      000006F4                           GOTO      K03K IF EOS
  606.                                . 
  607.                                .
  608.                                . DISPLAY IN THREE PLACES.
  609.      000006FA                           DISPLAY   *P16:7,INVORDNO,*P56:7,INVORDNO,*P1:9,INVORDNO
  610.      00000700                           DISPLAY   *P15:9,TODAY,*P36:9,INVSHIP
  611.                                . 
  612.      00000706                  KLOC     CMATCH    "*" TO INVORDNO
  613.      00000710                           GOTO      K03KSPC IF NOT EQUAL
  614.      00000716                  KLOCA    REPLACE   "* "   IN INVORDNO
  615.      00000720                           KEYIN     *P01:23,"Enter Additional Customer P.O. Numbers: ",MOREORDR



PAGE   18      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  616.      00000726                           CMATCH    " " TO  MOREORDR
  617.      00000730                           GOTO      KLOCA IF EOS
  618.      00000736                           GOTO      K040K
  619.      0000073C                  K03KSPC  MATCH     "SPECIAL"  TO  INVORDNO
  620.      0000074A                           GOTO      K040K      IF  NOT  EQUAL
  621.      00000750                  SPCKEY   KEYIN     *P01:22,"Describe the SPECIAL charges (up to 50 chars)":
  622.                                                   *P01:23,INVMESG
  623.      00000756                           CMATCH    " "  TO  INVMESG
  624.      00000760                           GOTO      SPCKEY   IF  EOS
  625.      00000766                           MOVE      "S"      TO  INVTYPE        MAKE IT A SPECIAL
  626.                                *...........................................................
  627.      00000770                  K040K    GOTO      K08
  628.      00000776                           KEYIN     *P20:10,INVBLNO
                                                    *WARNING*
Warning: Statement has no label and follows unconditional goto.
  629.      0000077C                           CMATCH    "<"     TO INVBLNO
  630.      00000786                           GOTO      K03  IF EQUAL
  631.      0000078C                  K040A    DISPLAY   *P20:10,INVBLNO
  632.                                . 
  633.                                .
  634.                                *.................................
  635.      00000792                  K04      TRAPCLR   PARITY
  636.                                . FOB OR COLLECT
  637.                                . FIELD VALIDATION TYPE IS TABLE-LOOKUP
  638.                                .
  639.      00000798                  K07K     KEYIN     *P35:10,INVFOB
  640.      0000079E                           CMATCH    "<" TO INVFOB
  641.      000007A8                           GOTO      K07K  IF EOS
  642.      000007AE                           GOTO      K040K IF EQUAL
  643.      000007B4                           DISPLAY   *P35:10,INVFOB
  644.                                *.................................
  645.                                . FIELD MUST BE IN TABLE
  646.                                ..................................
  647.      000007BA                           CMATCH    "P" TO INVFOB
  648.      000007C4                           GOTO      K08 IF EQUAL
  649.      000007CA                           CMATCH    "C" TO INVFOB
  650.      000007D4                           GOTO      K08 IF EQUAL
  651.      000007DA                           BEEP 
  652.      000007E0                           GOTO      K07K
  653.                                . 
  654.      000007E6                  K09      DISPLAY   *P36:9,INVSHIP
  655.      000007EC                           KEYIN     *P36:9,*RV,INVSHIP
  656.      000007F2                           CMATCH    "<"  TO  INVSHIP 
  657.      000007FC                           GOTO      K040K IF EQUAL
  658.      00000802                           DISPLAY   *P36:9,INVSHIP
  659.      00000808                           GOTO      TERMSIN
  660.                                . 
  661.      0000080E                  K08      MOVE      "1" TO INVWGHT
  662.      00000818                           DISPLAY   *P25:9,INVWGHT
  663.      0000081E                           KEYIN     *P25:9,*RV,INVWGHT
  664.      00000824                           DISPLAY   *P25:9,INVWGHT
  665.                                . 
  666.      0000082A                  K081     MOVE      "1" TO CARTONS



PAGE   19      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  667.      00000834                           DISPLAY   *P31:9,CARTONS
  668.      0000083A                           KEYIN     *P31:9,*RV,CARTONS
  669.      00000840                           DISPLAY   *P31:9,CARTONS
  670.      00000846                           GOTO      K09
  671.                                . 
  672.      0000084C                  TERMSIN  DISPLAY   *P51:9,NORMTERM
  673.      00000852                           MOVE      NORMTERM TO NEWTERM
  674.      0000085C                           KEYIN     *P51:9,*RV,NEWTERM
  675.                                . 
  676.      00000862                  COMPLETE DISPLAY   *P73:9,"(",COMPLET,")"
  677.      00000868                           KEYIN     *P74:9,*RV,COMPLET
  678.      0000086E                           CMATCH    "C" TO COMPLET
  679.      00000878                           GOTO      COK IF EQUAL
  680.      0000087E                           CMATCH    "P" TO COMPLET
  681.      00000888                           GOTO      COK IF EQUAL
  682.      0000088E                           BEEP 
  683.      00000894                           GOTO      COMPLETE
  684.                                . 
  685.      0000089A                  WRITE    CMATCH    "O" TO TESTONE
  686.      000008A4                           GOTO      PDT IF NOT EQUAL
  687.      000008AA                           KEYIN     *P29:17,"OPERATOR",*P46:17,"____",*P46:17,*DE,INVKEY
  688.      000008B0                           CMATCH    " " TO INVKEY
  689.      000008BA                           GOTO      WRITE IF EOS
  690.      000008C0                           MOVE      INVKEY   TO  FORM5
  691.      000008CA                           MOVE      FORM5    TO  INVKEY
  692.                                . 
  693.      000008D4                  PDT      DISPLAY   *P01:24,*EL
  694.      000008DA                           KEYIN     *P19:19,"(mmddyy) IS: ______",*P32:19,*DE,INVDATE
  695.      000008E0                           CMATCH    " " TO INVDATE
  696.      000008EA                           GOTO      PDT IF EOS
  697.                                . 
  698.      000008F0                  DTKY     MOVE      " " TO REPLY
  699.      000008FA                           BEEP 
  700.      00000900                           KEYIN     *P01:24,"IS THE DATE CORRECT ? (Y/N) ",REPLY
  701.      00000906                           CMATCH    "Y" TO REPLY
  702.      00000910                           GOTO      PDT IF NOT EQUAL
  703.      00000916                           DISPLAY   *P01:24,*EL
  704.      0000091C                           MOVE      " " TO REPLY
  705.                                . 
  706.                                . ALWAYS INPUT THE INVOICE DATE
  707.                                . 
  708.      00000926                           RESET     INVDATE  TO  6
  709.      00000930                           GOTO      PDT  IF  EOS
  710.      00000936                           RESET     INVDATE  TO  6
  711.      00000940                           LENSET    INVDATE
  712.      00000946                           RESET     INVDATE  TO  1    (LENGTH=6, POINT AT 1)
  713.                                . 
  714.                                . NOW CHECK IF YOU WANT TO INPUT THE DOLLARS
  715.                                . 
  716.      00000950                  COK      MOVE      PASSDT6 TO INVDATE
  717.      0000095A                           COMPARE   "9" TO SECURITY
  718.      00000964                           GOTO      COKI IF NOT EQUAL
  719.                                . 



PAGE   20      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  720.      0000096A                  COKI     CMATCH    "S"  TO  INVTYPE
  721.      00000974                           GOTO      ORDDOLS  IF  EQUAL
  722.      0000097A                           CMATCH    "O"  TO  TESTONE
  723.      00000984                           GOTO      GETNUMB  IF  NOT  EQUAL
  724.                                . 
  725.                                . FALLTHRU INDICATES OLD INVOICE NO.
  726.                                . SO CHECK IF WE WANT TO INPUT THE DOLLARS
  727.                                . 
  728.      0000098A                  ORDDOLS  KEYIN     *P05:21,"INVOICE NET DOLLARS  _________",*P26:21,TOTDOLS
  729.      00000990                           MOVE      TOTDOLS  TO  INVTOTL
  730.      0000099A                           DISPLAY   *P26:21,INVTOTL
  731.      000009A0                           CMATCH    "O"      TO  TESTONE
  732.      000009AA                           GOTO      W1  IF   EQUAL
  733.                                . 
  734.                                . FALLTHRU INDICATES A NEW INVOICE, SPECIAL OR MERCHANDISE
  735.                                . 
  736.      000009B0                  GETNUMB  TRAPCLR   PARITY            (WE ALREADY READ THE CONTROL FILE!)
  737.                                . 
  738.      000009B6                           FILEPI    19;CONTROLS
  739.                                . 
  740.      000009C0                           MOVE      "APP" TO CTLKEY
  741.      000009CA                           CALL      GETCTL
  742.      000009D0                           MOVE      CTLINVC TO ADDKEY
  743.      000009DA                           ADD       "1"     TO ADDKEY
  744.      000009E0                           MOVE      TODAY   TO CTLDATE
  745.      000009EA                           MOVE      ADDKEY   TO  CTLINVC
  746.      000009F4                           CALL      PUTCTL                  (UPDATE FILE, RESERVING NUMBER)
  747.                                . 
  748.                                . STOP THE PI HERE
  749.                                . 
  750.      000009FA                           FILEPI   0
  751.      00000A04                           MOVE      ADDKEY   TO INVKEY
  752.      00000A0E                           REP       " 0"     IN INVKEY
  753.      00000A18                           DISPLAY   *P60:2,*HON,INVKEY,*HOFF
  754.      00000A1E                           MOVE      " " TO SPECSW
  755.                                . 
  756.                                . NEW 4/23/83   FOR APP
  757.                                . 
  758.      00000A28                           GOTO      W1
  759.                                ..........................................
  760.                                . 
  761.                                . CHECK TO SEE IF THIS IS A SPECIAL INVOICE!
  762.                                .       IF SO, DONT EVEN ASK FOR THE SPECIAL MESSAGE ENTRY
  763.                                .       AS IT OVERRIDES THE DEFINITION OF THE SPECIAL CHARGE
  764.                                .       WHICH HAS ALREADY BEEN STORED IN FIELD  - INVMESG -
  765.                                . 
  766.      00000A2E                           CMATCH    "S",INVTYPE
                                                     *WARNING*
Warning: Statement has no label and follows unconditional goto.
  767.      00000A38                           GOTO      OVRSPEC  IF NOT EQUAL
  768.      00000A3E                           MOVE      "X" TO SPECSW
  769.      00000A48                           GOTO      W1
  770.                                . 



PAGE   21      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:27
                                         

  771.                                . NOW ASK IF THEY WANT TO OVERRIDE THE SPECIAL MESSAGE
  772.                                . JUST FOR THIS CUSTOMER
  773.                                . 
  774.      00000A4E                  OVRSPEC  KEYIN    *P01:23,"OVERRIDE SPECIAL MESSAGE ? (Y/N) ",REPLY
  775.      00000A54                           CMATCH    "Y",REPLY
  776.      00000A5E                           GOTO      ASKSPEC IF EQUAL
  777.      00000A64                           CMATCH    "N",REPLY
  778.      00000A6E                           GOTO      W1 IF EQUAL
  779.      00000A74                           BEEP 
  780.      00000A7A                           MOVE      " ",REPLY
  781.      00000A84                           GOTO      OVRSPEC 
  782.      00000A8A                  ASKSPEC  KEYIN     *P01:23,*EL,*P01:23,"ENTER THE MESSAGE HERE !",*W2:
  783.                                                   *P01:23,*EL,*P01:24,INVMESG
  784.      00000A90                           DISPLAY   *P01:21,INVMESG,*P01:23,*EL
  785.      00000A96                           MOVE      "X"  TO  SPECSW
  786.                                . UPDATE THE CONTROL FILE LATER
  787.                                . 
  788.                                *...........................................................
  789.                                . DISK-WRITE SEQUENCE
  790.                                .
  791.      00000AA0                  W1       TRAPCLR   IO
  792.      00000AA6                           MOVE      "0000"  TO RECCNTR
  793.      00000AB0                           TRAP      BADDSK IF IO
  794.      00000ABE                           MOVE      INVKEY    TO   INVCNUMB
  795.      00000AC8                           MOVE      CUSTNAME  TO   PASSCUST
  796.      00000AD2                           MOVE      INVTOTL   TO   IDOLSLFT
  797.                                . 
  798.                                . CHECK FOR OVERRIDE ON SPECIAL MESSAGE
  799.                                . 
  800.      00000ADC                           CMATCH    "X",SPECSW
  801.      00000AE6                           GOTO      MOVESPEC IF NOT EQUAL
  802.      00000AEC                           MOVE      " " TO SPECSW
  803.      00000AF6                           GOTO      W1A
  804.                                . 
  805.      00000AFC                  MOVESPEC MOVE      SPECMSG   TO   INVMESG
  806.                                . 
  807.                                . NOW WRITE TO THE NEW DA FILE FOR BATCH REVIEW/CORRECTION CAPABILITY
  808.                                . 
  809.      00000B06                  W1A      TRAPCLR   IO
  810.      00000B0C                           TRAPCLR   FORMAT
  811.      00000B12                           TRAPCLR   RANGE
  812.      00000B18                           TRAPCLR   PARITY
  813.      00000B1E                           TRAP      BADDSK IF IO
  814.      00000B2C                           TRAP      BUMFMT IF FORMAT
  815.      00000B3A                           WRITE     DAFILE,REC1;INVKEY:
  816.                                                   INVTYPE:
  817.                                                   INVCOMP:
  818.                                                   INVSTAT:
  819.                                                   INVCUST:
  820.                                                   INVDATE:
  821.                                                   INVTOTL:
  822.                                                   INVORDNO:
  823.                                                   MOREORDR:



PAGE   22      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

  824.                                                   INVSHIP:
  825.                                                   INVBLNO:
  826.                                                   INVFOB:
  827.                                                   FRGTRATE:
  828.                                                   INVWGHT:
  829.                                                   INVDTPAY:
  830.                                                   INVCHECK:
  831.                                                   IAMTRCVD:
  832.                                                   IDOLSLFT:
  833.                                                   INVMESG:
  834.                                                   RECCNTR:          (TOTAL RECORD COUNTER)
  835.                                                   RECCNTR           (LIVE RECORD COUNTER)
  836.                                . 
  837.                                ..............  8/10/85
  838.                                .
  839.      00000B44                           MOVE      REC1 TO DARECNO
  840.                                .
  841.                                ..............  8/10/85
  842.                                .
  843.                                . NOW WRITE AN END-OF-FILE AT SECTOR 1 (IE REC #2)
  844.                                .
  845.                                ...............       WEOF      DAFILE,REC2
  846.                                ...............       MOVE      REC2 TO DARECNO
  847.                                ...............       SUBTRACT  "1" FROM DARECNO
  848.                                .
  849.      00000B4E                           GOTO      EOJ
  850.                                .
  851.      00000B54                  BUMFMT   BEEP 
  852.      00000B5A                           DISPLAY   *P1:23,"FORMAT ERROR ON WRITE TO DAFILE"
  853.      00000B60                           GOTO      EOJ
  854.                                .
  855.                                . 
  856.      00000B66                  BADDSK   BEEP 
  857.      00000B6C                           DISPLAY   *ES,*P01:01,"BAD WRITE TO DISK, RECORD ZERO ON ":
  858.                                                               "INVOICE DA FILE":
  859.                                                       *P01:03,"UNRECOVERABLE ERROR...CALL MICRO ":
  860.                                                               "SYSTEMS CONSULTANTS",*W2
  861.      00000B72                           GOTO      BADDSK
  862.                                . 
  863.                                . ISAM DUPLICATE KEY TRAP
  864.                                .
  865.      00000B78                  DUPKEY   BEEP 
  866.      00000B7E                           DISPLAY   *P01:23,"KEY ",INVKEY," ALREADY EXISTS! ":
  867.                                                           "ASSIGN A NEW ONE!",*W,*W,*W
  868.      00000B84                           GOTO      WRITE



PAGE   23      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

  869.                                *...........................................................
  870.                                . END OF JOB SEQUENCE
  871.                                .
  872.      00000B8A                  EOJ      CMATCH    "O"  TO  TESTONE
  873.      00000B94                           GOTO      EOJ1 IF  EQUAL     (DONT ADD AN OLD SPECIAL TO $TOTS)
  874.                                . 
  875.                                . FALLTHRU MEANS ITS NEW!
  876.                                . 
  877.      00000B9A                           CMATCH    "S"  TO  INVTYPE
  878.      00000BA4                           GOTO      EOJ2 IF  NOT EQUAL   (ITS NORMAL MERCHANDISE INVOICE)
  879.      00000BAA                           GOTO      UPDTSEQ
  880.                                . 
  881.                                . EOJ2 IS ONLY FOR NEW REGULAR MERCHANDISE INVOICES
  882.                                . 
  883.      00000BB0                  EOJ2     CALL      PUTCTL
  884.      00000BB6                           GOTO      CHAINDET
  885.                                . 
  886.                                . EOJ1 IS FOR EITHER OLD MERCHANDISE OR OLD SPECIAL INVOICES
  887.                                . 
  888.      00000BBC                  EOJ1     CALL      PUTCTL                   (ALWAYS WRITE IT BACK REGARDLESS)
  889.      00000BC2                           CMATCH    "S"  TO  INVTYPE       (WAS IT AN OLD SPECIAL?)
  890.      00000BCC                           GOTO      KEYMOR   IF  EQUAL     (YES..BYPASS DETAIL ENTRY OPTION)
  891.                                . 
  892.                                . FALLTHRU IS AN OLD INVOICE
  893.                                .  DETAIL OPTION WAS PROVIDED JUST FOR NOVEMBER 1979 ENTRY
  894.                                . 
  895.      00000BD2                  KEYOLD   DISPLAY   *P01:23,*EL
  896.      00000BD8                           KEYIN     *P01:23,"DO YOU WISH TO ENTER DETAILS FOR THIS ":
  897.                                                   "INVOICE ? (DEPLETE INVENTORY) Y or N ",OLDDET
  898.      00000BDE                           CMATCH    "Y"  TO  OLDDET
  899.      00000BE8                           GOTO      CHAINDET  IF  EQUAL
  900.      00000BEE                           CMATCH    "N"  TO  OLDDET
  901.      00000BF8                           GOTO      KEYMOR    IF  EQUAL
  902.      00000BFE                           BEEP 
  903.      00000C04                           GOTO      KEYOLD
  904.      00000C0A                  KEYMOR   DISPLAY   *P01:23,*EL
  905.      00000C10                           KEYIN     *P01:23,"ANY MORE SPECIAL INVOICES TO ADD TO THE ":
  906.                                                           "INVOICE HEADER FILE? ",REPLY
  907.      00000C16                           CMATCH    "Y" TO REPLY
  908.      00000C20                           GOTO      WHATKIND IF EQUAL
  909.      00000C26                           CMATCH    "N" TO REPLY
  910.      00000C30                           GOTO      INDXIT IF EQUAL
  911.      00000C36                           BEEP 
  912.      00000C3C                           GOTO      KEYMOR
  913.                                . 
  914.      00000C42                  EOJOUT   RELEASE 
  915.      00000C44                           CHAIN     "APPINVC1"
  916.                                .
  917.      00000C4A                           STOP 
  918.                                .
  919.                                . FILE OPENING SEQUENCE
  920.      00000C4C                  CHAINDET MOVE      " "  TO  KREPLY
  921.      00000C56                           MOVE      "0001" TO RECCNTR



PAGE   24      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

  922.      00000C60                           MOVE      INVCNUMB TO CHKPASS
  923.      00000C6A                           RESET     CHKPASS TO 5
  924.      00000C74                           CMATCH    " " TO CHKPASS
  925.      00000C7E                           GOTO      CONTIN IF NOT EOS
  926.                                . 
  927.      00000C84                  BADINVC  BEEP 
  928.      00000C8A                           DISPLAY   *ES,*P01:12,"SORRY..YOU HAVE NOT GIVEN ME A INVOICE NUMBER":
  929.                                                       *P01:14,"  I CANNOT ALLOW YOU TO CONTINUE",*W,*W
  930.      00000C90                           BEEP 
  931.      00000C96                           GOTO      MAINLINE
  932.                                . 
  933.      00000C9C                  CONTIN   RESET     CHKPASS
  934.      00000CA6                           TYPE      CHKPASS
  935.      00000CAC                           GOTO      BADINVC IF NOT EQUAL
  936.      00000CB2                           GOTO      HSKPG1
  937.                                . 
  938.      00000CB8                  HSKPG1   TRAPCLR   IO
  939.      00000CBE                           MOVE      "00" TO INVLINES
  940.      00000CC8                           MOVE      INVCNUMB TO INVKEY
  941.      00000CD2                           MOVE      INVCNUMB TO INVCNO
  942.      00000CDC                           MOVE      PASSDT6  TO  DATE2X
  943.      00000CE6                  TYPIT    TYPE      DATE2X
  944.      00000CEC                           GOTO      DATEOK  IF  EQUAL
  945.      00000CF2                           BEEP 
  946.      00000CF8                  KEYIT    KEYIN     *ES,*P01:12,"ENTER THE MONTH AS TWO DIGITS,  SUCH AS  09 ":
  947.                                                   "FOR SEPT. ",*DE,DATE2X
  948.      00000CFE                           GOTO      TYPIT
  949.                                . 
  950.      00000D04                  DATEOK   MOVE      DATE2X  TO  DATE2N
  951.      00000D0E                           COMPARE   "0"     TO  DATE2N
  952.      00000D18                           GOTO      KEYIT   IF  EQUAL
  953.      00000D1E                           GOTO      KEYIT   IF  LESS
  954.      00000D24                           COMPARE   "13"    TO  DATE2N
  955.      00000D2E                           GOTO      KEYIT   IF  NOT  LESS
  956.                                . 
  957.                                .  GOT A GOOD MONTH THERE
  958.                                . 
  959.      00000D34                           MOVE      DATE2N  TO  USAGINDX
  960.                                . 
  961.                                . USAGE IS NOW SET UP FOR UPDATE
  962.                                . 
  963.                                *...........................................................
  964.                                . INITIAL SCREEN DISPLAY SEQUENCE
  965.                                .
  966.      00000D3E                  RECYCLE  MOVE      "10" TO ROW
  967.      00000D48                           DISPLAY   *P01:10,*EF:
  968.                                                   *HON:
  969.                                                   "QTY ORD  QTY SHP  QTY B/O  PART NUMBER              ":
  970.                                                   "PROD  PRICE  UOM EXTENSION  ",*HOFF
  971.      00000D4E                  LOOP01  KEYIN     *P01:23,*EL,*HON,"Press ENTER to add data, F5 if ":
  972.                                                          "done ",REPLY,*HOFF
  973.      00000D54                           GOTO      BIGEOJ  IF  F5
  974.      00000D5E                           CMATCH    " " TO REPLY



PAGE   25      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

  975.      00000D68                           GOTO      LOOP01 IF NOT EOS
  976.      00000D6E                           DISPLAY   *P01:23,*EL
  977.                                *...........................................................
  978.                                . KEYIN VARIABLES SEQUENCE
  979.      00000D74                           ADD       "01" TO ROW
  980.      00000D7A                           COMPARE   "21" TO ROW
  981.      00000D84                           GOTO      RECYCLE IF NOT LESS
  982.                                . 
  983.      00000D8A                           DISPLAY   *P01:ROW,"_______  _______  _______  ":
  984.                                                            "_________________________    ":
  985.                                                            "________ __  _________  "
  986.                                . 
  987.                                *...........................................................
  988.                                . PART NO. 1
  989.                                . THIS FIELD IS "BOTH" REQUIRED & FILL-CONTROLLED
  990.                                . FIELD TYPE IS NUMERIC
  991.                                .
  992.      00000D90                           MOVE      "0" TO LNDOLS
  993.      00000D9A                           MOVE      "0" TO KEGQTY
  994.      00000DA4                           MOVE      "0" TO PCSSOLD
  995.      00000DAE                           MOVE      "0" TO INVCKEGS
  996.      00000DB8                           MOVE      "0" TO INVPCSKG
  997.      00000DC2                           MOVE      "0" TO LINECOST
  998.                                *...........................................................
  999.                                . QUANTITY ORDERED           4/23/83
 1000.                                . FIELD TYPE IS NUMERIC
 1001.                                .
 1002.      00000DCC                  B03      MOVE      FIELD03 TO SAVE
 1003.      00000DD6                  B03K     KEYIN     *P01:ROW,"_______  ":
 1004.                                                   *P01:ROW,WORK09
 1005.                                . 
 1006.      00000DDC                  B03A     CLEAR     FIELD09
 1007.      00000DE2                           MOVE      WORK09 TO FIELD09
 1008.      00000DEC                  B03B     MOVE      "0" TO NFIELD09
 1009.      00000DF6                           TYPE      FIELD09     (NUMERIC FIELD)
 1010.      00000DFC                           GOTO      B03K IF NOT EQUAL
 1011.                                . 
 1012.                                .  BEEP IT HERE TO WAKE UP THE OPERATOR
 1013.                                . 
 1014.      00000E02                           MOVE      FIELD09 TO NFIELD09
 1015.      00000E0C                  B03C     MOVE      NFIELD09 TO FIELD09
 1016.      00000E16                           DISPLAY   *P01:ROW,FIELD09
 1017.                                . 
 1018.      00000E1C                           MOVE      NFIELD09 TO INVCKEGS
 1019.                                . 
 1020.                                . CHECK IF ORDER IS COMPLETE AND DISPLAY ACCORDINGLY
 1021.                                . 
 1022.      00000E26                           CMATCH    "C",COMPLET
 1023.      00000E30                           GOTO      PCSKEG IF NOT EQUAL
 1024.                                . 
 1025.                                . FALLTHRU MEANS COMPLETE SO DISPLAY ORDER QUANTITY AS SHIPPED QTY
 1026.                                . AND DISPLAY ZERO IN BACKORDER FIELD
 1027.                                . 



PAGE   26      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1028.      00000E36                           DISPLAY   *P10:ROW,INVCKEGS,*P19:ROW,"      0"
 1029.      00000E3C                           MOVE      INVCKEGS TO PCSSOLD
 1030.      00000E46                           MOVE      "0"      TO INVPCSKG     (ZERO OUT B/O FIELD)
 1031.      00000E50                           GOTO      GETPARTZ
 1032.                                . ........................................
 1033.                                . 
 1034.                                . NOTE USE INVCKEGS FOR QUANTITY ORDERED
 1035.                                .      USE PCSSOLD  FOR QUANTITY SHIPPED
 1036.                                .      USE INVPCSKG FOR QUANTITY BACKORDERED
 1037.                                . 
 1038.                                . 
 1039.      00000E56                  PCSKEG   KEYIN     *P10:ROW,"_______  ",*P10:ROW,PCSSOLD
 1040.                                . 
 1041.      00000E5C                           DISPLAY   *P10:ROW,PCSSOLD
 1042.                                . 
 1043.      00000E62                           MOVE      INVCKEGS TO KEGQTY
 1044.      00000E6C                           SUBTRACT  PCSSOLD  FROM  KEGQTY
 1045.      00000E76                           MOVE      KEGQTY   TO    INVPCSKG
 1046.      00000E80                           DISPLAY   *P19:ROW,INVPCSKG
 1047.      00000E86                           GOTO      GETPARTZ
 1048.                                . 
 1049.                                . 
 1050.      00000E8C                  AHA      BEEP 
 1051.      00000E92                           GOTO      AHA
 1052.                                . 
 1053.                                *.........................................................
 1054.      00000E98                  GETPARTZ MOVE      "0" TO MULTICNT
 1055.      00000EA2                           MOVE      " " TO MULTIFLG
 1056.      00000EAC                           DISPLAY   *P1:23,*HON,"PRESS F1 FOR MULTI-LINE PART NUMBER":
 1057.                                                   *HOFF
 1058.      00000EB2                           KEYIN     *P28:ROW,"_________________________":
 1059.                                                   *P28:ROW,MULTIDSC
 1060.      00000EB8                           DISPLAY   *P28:ROW,MULTIDSC
 1061.      00000EBE                           MOVE      MULTIDSC TO MD1
 1062.      00000EC8                           MOVE      "1" TO MULTICNT
 1063.      00000ED2                           GOTO      MULTISET IF F1    (IF F1..THERE IS MULTI-LINE DESCRIPTION)
 1064.                                .
 1065.      00000EDC                           GOTO      B04
 1066.                                . 
 1067.                                *..........................................................
 1068.                                . 
 1069.      00000EE2                  MULTISET MOVE      "X" TO MULTIFLG
 1070.      00000EEC                           BEEP 
 1071.      00000EF2                           DISPLAY   *P1:23,*EL
 1072.      00000EF8                           DISPLAY   *P1:23,*HON,"MULTI-LINE (MAX 10) PART NUMBER",*W2,*HOFF
 1073.      00000EFE                           GOTO      B04
 1074.                                ...........................................................
 1075.                                . 
 1076.      00000F04                  MULTIDSC MOVE      ROW TO MULTIROW
 1077.      00000F0E                  MULTILP  ADD       "1" TO MULTIROW
 1078.      00000F14                           COMPARE   "22"   TO  MULTIROW
 1079.      00000F1E                           CALL      RESETROW   IF  NOT LESS
 1080.      00000F24                           KEYIN     *P28:MULTIROW,"_________________________":



PAGE   27      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1081.                                                   *P28:MULTIROW,MULTIDSC
 1082.      00000F2A                           DISPLAY   *P28:MULTIROW,MULTIDSC
 1083.      00000F30                           RESET     MULTIDSC
 1084.      00000F3A                           GOTO      B04 IF EOS       (IF NOTHING ENTERED...FORGET IT!)
 1085.      00000F40                           ADD       "1" TO MULTICNT
 1086.      00000F46                           STORE     MULTIDSC INTO MULTICNT OF MD1,MD2,MD3,MD4,MD5:
 1087.                                                                             MD6,MD7,MD8,MD9,MD10
 1088.                                . 
 1089.      00000F58                           COMPARE   "10" TO MULTICNT
 1090.      00000F62                           GOTO      MULTIRTN IF EQUAL
 1091.                                . 
 1092.      00000F68                           GOTO      MULTILP IF F1
 1093.                                . 
 1094.      00000F72                  MULTIRTN MOVE      MULTIROW  TO  ROW    (LET PROGRAM KNOW!)
 1095.      00000F7C                           RETURN                     (NO MORE!)
 1096.                                . 
 1097.                                ..............................................................
 1098.                                . 
 1099.      00000F7E                  RESETROW MOVE      "10" TO MULTIROW
 1100.      00000F88                  RESETLP  ADD       "1"  TO MULTIROW
 1101.      00000F8E                           COMPARE   "21" TO MULTIROW
 1102.      00000F98                           GOTO      RESETOUT IF EQUAL
 1103.      00000F9E                           DISPLAY   *P01:MULTIROW,*EL
 1104.      00000FA4                           GOTO      RESETLP
 1105.      00000FAA                  RESETOUT MOVE      "12" TO MULTIROW
 1106.      00000FB4                           MOVE      "12" TO ROW
 1107.      00000FBE                           RETURN 
 1108.                                . 
 1109.                                . 
 1110.      00000FC0                  EXTEND   RETURN 
 1111.      00000FC2                  WRTHDRIS RETURN 
 1112.                                . 
 1113.                                         INCLUDE   RCVBLSIO.TXT
 1113.    INCLUDE  H: f:\source\rcvblsio.txt
    1. H                              . 
    2. H                              ...............................................................
    3. H                              .      RECEIVABLES FILE INPUT/OUTPUT ROUTINES
    4. H                              ...............................................................
    5. H                              . 
    6. H    00000FC4                  OPENRCVB TRAPCLR   IO
    7. H    00000FCA                           TRAP      NORCVBHD IF IO
    8. H    00000FD8                           OPEN      RCVBFILE,RCVBNAME
    9. H    00000FE6                           RETURN 
   10. H                              . 
   11. H    00000FE8                  NORCVBHD BEEP 
   12. H    00000FEE                           DISPLAY   *ES,*P01:12,"RECEIVABLES FILE NOT ON LINE - ":
   13. H                                                             "JOB ABORTING ",*W,*W,*W
   14. H    00000FF4                           BEEP 
   15. H    00000FFA                           CHAIN     "ARMENU1"
   16. H                              . 
   17. H    00001000                  RCVIOERR BEEP 
   18. H    00001006                           DISPLAY   *ES,*P01:12,"WARNING! RECEIVABLES FILE I/O ERROR":
   19. H                                                     *P01:13,"NOTIFY MICRO SYSTEMS CONSULTANTS - 751-6076"



PAGE   28      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

   20. H    0000100C                           BEEP 
   21. H    00001012                           GOTO      RCVIOERR
   22. H                              . 
   23. H    00001018                  GETRCVB  TRAPCLR   IO
   24. H    0000101E                           TRAP      RCVNTFD IF IO
   25. H    0000102C                           MOVE      "M"  TO  IOSW
   26. H    00001036                           READ      RCVBFILE,STARTKEY;INVKEY,INVTYPE,INVCOMP,INVSTAT,INVCUST:
   27. H                                                                 INVDATE,INVTOTL,IPMNTS:
   28. H                                                                 IAMTPD1,IAMTPD2,IAMTPD3,IAMTPD4,IAMTPD5:
   29. H                                                                 ICHK1,ICHK2,ICHK3,ICHK4,ICHK5:
   30. H                                                                 IDTPD1,IDTPD2,IDTPD3,IDTPD4,IDTPD5:
   31. H                                                                 IDOLSLFT,IPRGDTE
   32. H                              . 
   33. H    00001040                           GOTO      RCVNTFD IF OVER
   34. H    00001046                           MOVE      "H"  TO IOSW
   35. H    00001050                           RETURN 
   36. H                              . 
   37. H                              . 
   38. H    00001052                  ADDRCVB  TRAPCLR   IO
   39. H    00001058                           TRAP      RCVDUPE IF IO
   40. H    00001066                           MOVE      "M" TO IOSW
   41. H    00001070                           WRITE     RCVBFILE,STARTKEY;INVKEY,INVTYPE,INVCOMP,INVSTAT,INVCUST:
   42. H                                                                 INVDATE,INVTOTL,IPMNTS:
   43. H                                                                 IAMTPD1,IAMTPD2,IAMTPD3,IAMTPD4,IAMTPD5:
   44. H                                                                 ICHK1,ICHK2,ICHK3,ICHK4,ICHK5:
   45. H                                                                 IDTPD1,IDTPD2,IDTPD3,IDTPD4,IDTPD5:
   46. H                                                                 IDOLSLFT,IPRGDTE
   47. H                              . 
   48. H    0000107A                           MOVE      "H"  TO IOSW
   49. H                              . 
   50. H    00001084                  RCVBRTRN RETURN 
   51. H                              . 
   52. H    00001086                  RCVNTFD  MOVE      "M"  TO IOSW
   53. H    00001090                           GOTO      RCVBRTRN
   54. H                              . 
   55. H    00001096                  RCVDUPE  BEEP 
   56. H    0000109C                           DISPLAY   *P01:23,*HON,"INVOICE NUMBER ALREADY EXISTS!":
   57. H                                                 *P01:23,*EL
   58. H    000010A2                           GOTO      RCVNTFD
   59. H                              . 
   60. H    000010A8                  PUTRCVB  TRAPCLR   IO
   61. H    000010AE                           TRAP      RCVIOERR IF IO
   62. H    000010BC                           UPDATE    RCVBFILE;INVKEY,INVTYPE,INVCOMP,INVSTAT,INVCUST:
   63. H                                                          INVDATE,INVTOTL,IPMNTS:
   64. H                                                          IAMTPD1,IAMTPD2,IAMTPD3,IAMTPD4,IAMTPD5:
   65. H                                                          ICHK1,ICHK2,ICHK3,ICHK4,ICHK5:
   66. H                                                          IDTPD1,IDTPD2,IDTPD3,IDTPD4,IDTPD5:
   67. H                                                          IDOLSLFT,IPRGDTE
   68. H                              . 
   69. H    000010C6                           MOVE      "H" TO IOSW
   70. H    000010D0                           RETURN 
   71. H                              . 
   72. H    000010D2                  RCVBSKS  TRAPCLR   IO



PAGE   29      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

   73. H    000010D8                           TRAP      RCVIOERR IF IO
   74. H    000010E6                           READKS    RCVBFILE;INVKEY,INVTYPE,INVCOMP,INVSTAT,INVCUST:
   75. H                                                          INVDATE,INVTOTL,IPMNTS:
   76. H                                                          IAMTPD1,IAMTPD2,IAMTPD3,IAMTPD4,IAMTPD5:
   77. H                                                          ICHK1,ICHK2,ICHK3,ICHK4,ICHK5:
   78. H                                                          IDTPD1,IDTPD2,IDTPD3,IDTPD4,IDTPD5:
   79. H                                                          IDOLSLFT,IPRGDTE
   80. H                              . 
   81. H    000010F0                           GOTO      EOFRCVB IF OVER
   82. H    000010F6                           MOVE      "H" TO IOSW
   83. H    00001100                           RETURN 
   84. H                              . 
   85. H    00001102                  EOFRCVB  MOVE      "E" TO IOSW
   86. H    0000110C                           RETURN 
   87. H                              . 
   88. H                              . END OF RECEIVABLES I/O ROUTINES
   89. H                              . 
   90. H                              .......................................................................
   91. H                              . 
 1114.                                . 
 1115.                                . 
 1116.                                . FALLTHRU IS NO MORE DESCRIPTIONS, SO GOTO B04
 1117.                                *...........................................................
 1118.                                . PRICE LN 1
 1119.                                . THIS FIELD IS REQUIRED
 1120.                                . FIELD TYPE IS NUMERIC
 1121.                                . 
 1122.      0000110E                  B04      MOVE      FIELD04 TO SAVE
 1123.      00001118                           GOTO      B04K
 1124.                                . 
 1125.      0000111E                           KEYIN     *P54:ROW,"__",*P54:ROW,PRODCODE
                                                    *WARNING*
Warning: Statement has no label and follows unconditional goto.
 1126.      00001124                           DISPLAY   *P54:ROW,PRODCODE
 1127.                                .
 1128.      0000112A                  B04K     KEYIN     *P57:ROW,"________":
 1129.                                                   *P57:ROW,WORK08
 1130.      00001130                           CMATCH    "<" TO WORK08
 1131.      0000113A                           GOTO      B04K IF EOS
 1132.      00001140                           CMATCH    ">" TO WORK08
 1133.      0000114A                           GOTO      B04A IF NOT EQUAL
 1134.      00001150                           MOVE      SAVE TO FIELD04
 1135.      0000115A                           DISPLAY   *P57:ROW,FIELD04
 1136.      00001160                           GOTO      B04K
 1137.      00001166                  B04A     CLEAR     FIELD04
 1138.      0000116C                           MOVE      WORK08 TO FIELD04
 1139.      00001176                  B04B     MOVE      "0" TO NFIELD04
 1140.      00001180                           TYPE      FIELD04     (NUMERIC FIELD)
 1141.      00001186                           GOTO      B04K IF NOT EQUAL
 1142.      0000118C                           MOVE      FIELD04 TO NFIELD04
 1143.      00001196                  B04C     MOVE      NFIELD04 TO FIELD04
 1144.      000011A0                           DISPLAY   *P57:ROW,FIELD04
 1145.      000011A6                           MOVE      NFIELD04 TO LNDOLS     (SELLING PRICE/UOM)



PAGE   30      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1146.                                . 
 1147.                                . GET THE UNIT OF MEASURE
 1148.                                . 
 1149.      000011B0                  UOM      MOVE      "  " TO  UOM
 1150.      000011BA                           KEYIN     *P66:ROW,UOM
 1151.                                . 
 1152.      000011C0                           MATCH     "GR" TO UOM
 1153.      000011CE                           GOTO      DUOM IF EQUAL
 1154.      000011D4                           MATCH     "EA" TO UOM
 1155.      000011E2                           GOTO      DUOM IF EQUAL
 1156.      000011E8                           MATCH     "M " TO UOM
 1157.      000011F6                           GOTO      DUOM IF EQUAL
 1158.      000011FC                           MATCH     "LT" TO UOM
 1159.      0000120A                           GOTO      DUOM IF EQUAL
 1160.      00001210                           MATCH     "LB" TO UOM
 1161.      0000121E                           GOTO      DUOM IF EQUAL
 1162.      00001224                           MATCH     "C " TO UOM
 1163.      00001232                           GOTO      DUOM IF EQUAL
 1164.      00001238                           MATCH     "FT" TO UOM
 1165.      00001246                           GOTO      DUOM IF EQUAL
 1166.      0000124C                           MATCH     "PK" TO UOM
 1167.      0000125A                           GOTO      DUOM IF EQUAL
 1168.      00001260                           MATCH     "BX" TO UOM
 1169.      0000126E                           GOTO      DUOM IF EQUAL
 1170.      00001274                           MATCH     "RD" TO UOM
 1171.      00001282                           GOTO      DUOM IF EQUAL
 1172.      00001288                           MATCH     "NC" TO UOM
 1173.      00001296                           GOTO      DUOM IF EQUAL
 1174.      0000129C                           BEEP 
 1175.      000012A2                           DISPLAY   *P66:ROW,"  "
 1176.      000012A8                           GOTO      UOM
 1177.                                . 
 1178.      000012AE                  DUOM     DISPLAY   *P66:ROW,UOM
 1179.                                . 
 1180.                                . 
 1181.      000012B4                  CHK100X  MATCH     "C " TO UOM
 1182.      000012C2                           GOTO      CHK1000 IF NOT EQUAL
 1183.      000012C8                           MOVE      PCSSOLD TO CALCFLD
 1184.      000012D2                           DIVIDE    "100" INTO CALCFLD
 1185.      000012DC                           MULT      LNDOLS BY CALCFLD
 1186.      000012E6                           MOVE      CALCFLD TO LINECOST
 1187.      000012F0                           GOTO      DSPCOSTX
 1188.                                . 
 1189.                                . 
 1190.      000012F6                  CHK1000  MATCH     "M " TO UOM
 1191.      00001304                           GOTO      EACHX   IF NOT EQUAL
 1192.      0000130A                           MOVE      PCSSOLD TO CALCFLD
 1193.      00001314                           DIVIDE    "1000"  INTO CALCFLD
 1194.      0000131E                           MULT      LNDOLS  BY   CALCFLD
 1195.      00001328                           MOVE      CALCFLD TO   LINECOST
 1196.      00001332                           GOTO      DSPCOSTX
 1197.                                . 
 1198.      00001338                  EACHX    MOVE      PCSSOLD TO LINECOST



PAGE   31      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1199.                                . 
 1200.      00001342                  EACHXX   MULT      LNDOLS BY LINECOST
 1201.                                . 
 1202.      0000134C                  DSPCOSTX DISPLAY   *P70:ROW,LINECOST
 1203.                                . 
 1204.                                . FIRST CHECK IF THE LINE IS OKAY!
 1205.                                . 
 1206.      00001352                  CHKLINE  BEEP 
 1207.      00001358                           MOVE      " " TO REPLY
 1208.      00001362                           KEYIN     *P1:22,*EL,*HON,"IS DATA CORRECT ? (Y/N) ",REPLY,*HOFF
 1209.      00001368                           DISPLAY   *P1:22,*EF
 1210.      0000136E                           CMATCH    "Y",REPLY
 1211.      00001378                           GOTO      CONTXX IF EQUAL
 1212.                                . 
 1213.      0000137E                           CMATCH    "N",REPLY
 1214.      00001388                           GOTO      LNRESET IF EQUAL
 1215.      0000138E                           BEEP 
 1216.      00001394                           GOTO      CHKLINE
 1217.                                . 
 1218.      0000139A                  LNRESET  DISPLAY   *P1:ROW,*EL
 1219.      000013A0                           SUBTRACT  "1" FROM ROW
 1220.      000013A6                           GOTO      LOOP01
 1221.                                . 
 1222.      000013AC                  CONTXX   ADD       LINECOST TO TOTDOLS
 1223.      000013B6                           ADD       LINECOST TO INVTOTL
 1224.                                . 
 1225.      000013C0                  CHKMULTI CMATCH    "X",MULTIFLG
 1226.      000013CA                           CALL      MULTIDSC IF EQUAL    (GET THE EXTRA LINES)
 1227.                                . 
 1228.                                . NOTE IF EXTRA DESCRIPTIVE LINES EXIST, THEN WRITE CONTINUATION RECORDS
 1229.                                .      FOR DESCRIPTIVE DATA
 1230.                                . 
 1231.                                . 
 1232.                                . .
 1233.                                . 8/8/81  BYPASS ALL UPDATE CODE AT THIS POINT IN TIME UNTIL
 1234.                                .         IT IS DETERMINED THAT THE ENTIRE INVOICE IS CORRECT
 1235.                                .         AT WHICH TIME WE WILL WRITE THE INVOICE HEADER AND
 1236.                                .         ALL DETAILS FROM THE "DAINVCS/TXT  DA FILE" TO THE
 1237.                                .         INVCHDRS/ISI AND INVCDTLS/ISI FILES, UPDATING THE
 1238.                                .         INVENTF/ISI, CUSTMAST/ISI, USAGE/ISI, CONTROLS/ISI,
 1239.                                .         COMMODS/ISI, AND MAYBE THE NONSTDS/ISI FILES
 1240.                                . 
 1241.      000013D0                           GOTO      LINEINCR         (BYPASS THE UPDATES UNTIL LATER!)



PAGE   32      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1242.                                *...........................................................
 1243.                                . 
 1244.                                . DISK-WRITE SEQUENCE
 1245.                                .
 1246.      000013D6                  LINEINCR ADD       "01"   TO INVLINES
 1247.      000013DC                           MOVE      INVLINES  TO  RECCNTR
 1248.      000013E6                           MOVE      INVCNO    TO  INVDTKEY
 1249.      000013F0                           RESET     INVDTKEY  TO  5
 1250.      000013FA                           APPEND    INVLINES  TO  INVDTKEY
 1251.      00001404                           RESET     INVDTKEY
 1252.      0000140E                           REP       " 0" IN INVDTKEY
 1253.      00001418                           MOVE      "X"  TO  DTLSTAT
 1254.      00001422                           MOVE      MD1  TO  MULTIDSC
 1255.      0000142C                           CALL      PTDTLBK
 1256.                                . 
 1257.                                . NOW CHECK FOR MULTI-DESCRIPTIVE LINES AND WRITE MULTIPLE RECORDS NOW!
 1258.                                . 
 1259.      00001432                           CMATCH    "X",MULTIFLG
 1260.      0000143C                           GOTO      COMP99 IF NOT EQUAL
 1261.                                . 
 1262.                                . FALLTHRU MEANS WRITE CONTINUATION RECORDS
 1263.                                . 
 1264.                                . FIRST ZERO OUT THE QTY AND PRICE FIELDS
 1265.                                . 
 1266.      00001442                           MOVE      "0" TO INVCKEGS
 1267.      0000144C                           MOVE      "0" TO INVPCSKG
 1268.      00001456                           MOVE      "0" TO PCSSOLD
 1269.      00001460                           MOVE      ".00"  TO LNDOLS
 1270.      0000146A                           MOVE      ".00"  TO LINECOST
 1271.                                . 
 1272.                                . STORE LOOP
 1273.                                . 
 1274.      00001474                           MOVE      "1"  TO  INDX
 1275.                                . 
 1276.      0000147E                  STORLOOP ADD       "1"  TO  INDX    (STARTS AT MD2, INDX VALUE=2)
 1277.      00001484                           COMPARE   INDX TO  MULTICNT
 1278.      0000148E                           GOTO      COMP99 IF  LESS
 1279.                                . 
 1280.      00001494                           LOAD      MULTIDSC FROM INDX OF MD1,MD2,MD3,MD4,MD5,MD6:
 1281.                                                                         MD7,MD8,MD9,MD10
 1282.                                . 
 1283.      000014A6                           ADD       "01" TO INVLINES
 1284.      000014AC                           MOVE      INVLINES TO RECCNTR
 1285.      000014B6                           RESET     INVDTKEY TO 5
 1286.      000014C0                           APPEND    INVLINES TO INVDTKEY
 1287.      000014CA                           RESET     INVDTKEY TO 1
 1288.      000014D4                           REP       " 0" IN INVDTKEY
 1289.      000014DE                           MOVE      "*"  TO DTLSTAT
 1290.      000014E8                           CALL      PTDTLBK
 1291.      000014EE                           GOTO      STORLOOP
 1292.                                . 
 1293.                                ............................................
 1294.      000014F4                  PTDTLBK  TRAPCLR   IO



PAGE   33      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1295.      000014FA                           TRAPCLR   PARITY
 1296.      00001500                           TRAPCLR   FORMAT
 1297.      00001506                           TRAPCLR   RANGE
 1298.      0000150C                           MOVE      "WRITE" TO IOTYPE
 1299.      00001516                           MOVE      DANAME  TO IOERFILE
 1300.      00001520                           TRAP      STDIOERR IF IO
 1301.      0000152E                           TRAP      STDFMTER IF FORMAT
 1302.      0000153C                           TRAP      STDRANGE IF RANGE
 1303.      0000154A                           TRAP      STDPARER IF PARITY
 1304.                                ...............       MOVE      RECCNTR TO DARECNO
 1305.      00001558                           ADD       "1"     TO DARECNO
 1306.                                . 
 1307.      0000155E                           WRITE     DAFILE,DARECNO;INVDTKEY:
 1308.                                                   DTLSTAT:          TEMPORARY STATUS CODE
 1309.                                                   MULTIDSC:        PART DESCRIPTION
 1310.                                                   INVCKEGS:        QTY ORDERED
 1311.                                                   INVPCSKG:      QTY BACKORDERED
 1312.                                                   PCSSOLD:       TOTAL PIECES SHIPPED
 1313.                                                   LNDOLS:          SELLING PRICE
 1314.                                                   LINECOST:        EXTENSION PRICE                 5.2
 1315.                                                   UOM:             UNIT OF MEASURE
 1316.                                                   PRODCODE:         PRODUCT CODE
 1317.                                                   FILLER:
 1318.                                                   FILLER2
 1319.                                . 
 1320.                                ...............       ADD       "1" TO DARECNO
 1321.                                ...............       WEOF      DAFILE,DARECNO
 1322.                                . NOW CLEAR ALL NECESSARY FIELDS
 1323.                                . 
 1324.      00001568                           MOVE      "0" TO LINECOST
 1325.      00001572                  PTDTLRTN RETURN 
 1326.                                ....................................................................
 1327.                                . 
 1328.      00001574                  COMP99   COMPARE   "99"  TO  INVLINES
 1329.      0000157E                           GOTO      NINENINE  IF  EQUAL       (END THIS INVOICE...NOW!)
 1330.      00001584                           GOTO      LOOP01
 1331.                                . 
 1332.      0000158A                  DETIOERR BEEP 
 1333.      00001590                           DISPLAY   *ES,*P01:12,"WRITE ERROR ON APP INVOICE DETAIL FILE":
 1334.                                                       *P01:14,"PROGRAM ABORTING",*W5
 1335.      00001596                           BEEP 
 1336.      0000159C                           GOTO      INDXIT
 1337.                                . 
 1338.      000015A2                  DADTLIO  BEEP 
 1339.      000015A8                           DISPLAY   *ES,*P01:12,"WRITE ERROR ON RECORD ",DARECNO:
 1340.                                                               " OF INVOICE DA FILE":
 1341.                                                       *P01:14,"UNRECOVERABLE ERROR - CALL MICRO SYSTEMS":
 1342.                                                               " CONSULTANTS!"
 1343.      000015AE                           GOTO      DADTLIO
 1344.                                . 
 1345.      000015B4                  PUTSTDS  GOTO      COMP99
 1346.                                . 
 1347.      000015BA                  NINENINE BEEP 



PAGE   34      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1348.      000015C0                           DISPLAY   *P01:23,*EL,"99 ITEMS KEYED FOR  INVC# ",INVCNO:
 1349.                                                     " I AM CLOSING THIS INVOICE",*W,*W,*W
 1350.      000015C6                           BEEP 
 1351.      000015CC                           GOTO      BIGEOJ
 1352.                                . 
 1353.      000015D2                  NOTFND   BEEP 
 1354.      000015D8                           DISPLAY   *P01:ROW,*EL
 1355.      000015DE                           DISPLAY   *P01:ROW,"INVALID PART NUMBER - PLEASE RESUBMIT",*W2
 1356.      000015E4                           SUBTRACT  "1" FROM ROW
 1357.      000015EA                           GOTO      LOOP01
 1358.                                . 
 1359.                                *...........................................................
 1360.                                . END OF JOB SEQUENCE
 1361.                                .
 1362.      000015F0                  BIGEOJ   TRAPCLR   IO
 1363.      000015F6                           TRAP      NOINVOIC  IF IO
 1364.      00001604                           TRAPCLR   FORMAT
 1365.      0000160A                           TRAP      STDFMTER  IF FORMAT
 1366.                                . 
 1367.                                . FIRST WRITE AN END-OF-FILE MARK ON THE BATCH
 1368.                                . 
 1369.      00001618                           ADD        "01" TO DARECNO
 1370.      0000161E                           WEOF      DAFILE,DARECNO
 1371.                                . 
 1372.                                . 
 1373.                                . NOW SHOW THE SUBTOTAL AND ENTER THE SHIP/HANDLING AMOUNT
 1374.                                . 
 1375.      00001628                  DSPTOTS  DISPLAY   *P1:21,*EL,*P50:21,"SUBTOTAL",*P70:21,INVTOTL
 1376.      0000162E                           MOVE      ".00" TO CALCNET
 1377.      00001638                           DISPLAY   *P1:22,*EL,*P50:22,"SHIP/HAND CHGS",*P70:22,CALCNET
 1378.      0000163E                           KEYIN     *P1:22,"ENTER SHIPPING AND HANDLING CHARGE":
 1379.                                                   *P70:22,*RV,CALCNET
 1380.      00001644                           DISPLAY   *P70:22,CALCNET
 1381.      0000164A                           MOVE      INVTOTL TO LIBNET
 1382.      00001654                           ADD       CALCNET TO   LIBNET
 1383.      0000165E                           DISPLAY   *P1:23,*EL,*P50:23,"INVOICE NET",*P69:23,LIBNET
 1384.      00001664                           KEYIN     *P1:23,*HON,"TAP ENTER TO PROCEED ",REPLY,*HOFF
 1385.      0000166A                           MOVE      LIBNET TO INVTOTL
 1386.      00001674                           MOVE      LIBNET TO IDOLSLFT
 1387.      0000167E                           MOVE      INVTOTL TO TOTDOLS
 1388.                                ......   ADD       LIBNET TO REPNET
 1389.      00001688                           DISPLAY   *P1:23,"                          "
 1390.                                . 
 1391.                                . TEST FOR NEGATIVE INVOICE.
 1392.                                . 
 1393.      0000168E                           CMATCH    "I",INVTYPE
 1394.      00001698                           GOTO      XCRED IF NOT EQUAL
 1395.                                . 
 1396.      0000169E                           COMPARE   ".00" TO INVTOTL
 1397.      000016A8                           GOTO      XCRED IF EQUAL
 1398.                                . 
 1399.      000016AE                           COMPARE   ".01" TO INVTOTL
 1400.      000016B8                           GOTO      XCRED IF NOT LESS



PAGE   35      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1401.      000016BE                           BEEP 
 1402.      000016C4                           DISPLAY   *P1:24,*EL,*HON,"NEGATIVE INVOICE DISALLOWED!",*W4:
 1403.                                                   *P1:24,*EL
 1404.      000016CA                           GOTO      DSPTOTS
 1405.                                . 
 1406.      000016D0                  XCRED 
 1407.                                ................................   CALL      GTRCZRO
 1408.      000016D0                           MOVE      LIBNET  TO  INVTOTL
 1409.      000016DA                           MOVE      INVTOTL TO  IDOLSLFT
 1410.                                . ....   CALL      CALCDATA
 1411.      000016E4                           SUBTRACT  "1"        FROM  RECCNTR
 1412.      000016EA                           MOVE      RECCNTR    TO    IRECCNTR
 1413.      000016F4                           MOVE      RECCNTR    TO    ILIVCNTR
 1414.      000016FE                           CALL      PTRCZRO
 1415.                                .
 1416.      00001704                           GOTO      SHOWTOTS      (DISPLAY FINAL INVOICE TOTALS)
 1417.                                . 
 1418.                                . THEN UPDATE RECORD ZERO WITH THE COUNTS PRIOR TO REVIEW CYCLE
 1419.                                . 
 1420.      0000170A                  GTRCZRO  MOVE      "DAREAD"  TO IOTYPE
 1421.      00001714                           READ      DAFILE,REC1;INVKEY:
 1422.                                                                  INVTYPE:
 1423.                                                                  INVCOMP:
 1424.                                                                  INVSTAT:
 1425.                                                                  INVCUST:
 1426.                                                                  INVDATE:
 1427.                                                                  INVTOTL:
 1428.                                                                  INVORDNO:
 1429.                                                                  MOREORDR:
 1430.                                                                  INVSHIP:
 1431.                                                                  INVBLNO:
 1432.                                                                  INVFOB:
 1433.                                                                  FRGTRATE:
 1434.                                                                  INVWGHT:
 1435.                                                                  INVDTPAY:
 1436.                                                                  INVCHECK:
 1437.                                                                  IAMTRCVD:
 1438.                                                                  IDOLSLFT:
 1439.                                                                  INVMESG:
 1440.                                                                  IRECCNTR:
 1441.                                                                  ILIVCNTR
 1442.                                . 
 1443.      0000171E                           GOTO      NOINVOIC  IF OVER
 1444.      00001724                           MOVE      "H"  TO   IOSW
 1445.      0000172E                           RETURN 
 1446.                                . 
 1447.                                . ............................................
 1448.                                . 
 1449.      00001730                  PTRCZRO  WRITE     DAFILE,REC1;INVKEY:
 1450.                                                           INVTYPE:
 1451.                                                           INVCOMP:
 1452.                                                           INVSTAT:
 1453.                                                           INVCUST:



PAGE   36      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1454.                                                           INVDATE:
 1455.                                                           INVTOTL:
 1456.                                                           INVORDNO:
 1457.                                                           MOREORDR:
 1458.                                                           INVSHIP:
 1459.                                                           INVBLNO:
 1460.                                                           INVFOB:
 1461.                                                           FRGTRATE:
 1462.                                                           INVWGHT:
 1463.                                                           INVDTPAY:
 1464.                                                           INVCHECK:
 1465.                                                           IAMTRCVD:
 1466.                                                           IDOLSLFT:
 1467.                                                           INVMESG:
 1468.                                                           IRECCNTR:
 1469.                                                           ILIVCNTR
 1470.      0000173A                           RETURN 
 1471.                                . .....................................................
 1472.                                . 
 1473.      0000173C                  SHOWTOTS DISPLAY   *ES,*P01:12,"INVOICE NUMBER ",INVKEY," TOTAL NET ":
 1474.                                                               "INVOICE IS: $",TOTDOLS
 1475.      00001742                  CHECKIT  MOVE      " ",REPLY
 1476.      0000174C                           BEEP 
 1477.      00001752                           KEYIN     *P01:16,"IS THIS INVOICE CORRECT ?  (Y/N) ",REPLY
 1478.      00001758                           CMATCH    "Y",REPLY
 1479.      00001762                           GOTO      UPDTSEQ IF EQUAL      (NOW UPDATE ALL FILES! 7/81)
 1480.                                . 
 1481.      00001768                           CMATCH    "N",REPLY
 1482.      00001772                           GOTO      REVIEWIT IF EQUAL
 1483.                                . 
 1484.      00001778                           BEEP 
 1485.      0000177E                           GOTO      CHECKIT
 1486.                                . 
 1487.                                . THE FOLLOWING ROUTINE IS USED TO RETRIEVE ALL LINE ITEMS
 1488.                                . ON THIS INVOICE AND TO MODIFY THE STATUS CODE FROM "X" TO "O"
 1489.                                . 
 1490.      00001784                  UPDTSEQ  TRAPCLR   IO                (NOW ADD THE UPDATE LOGIC)
 1491.                                . 
 1492.                                . WHAT MUST NOW BE DONE IS THE FOLLOWING:
 1493.                                . 
 1494.                                . 1.  WRITE THE HEADER RECORD TO THE INVOICE MASTER FILE
 1495.                                . 2.  LOOP THROUGH ALL THE DETAIL RECORDS, SELECTING ONLY THOSE
 1496.                                .     WHICH HAVE A STATUS CODE OF "X", AND UPDATE THE INVENTORY MASTER
 1497.                                .     BY DECREMENTING THE ON-HAND QTY ACCORDING TO THE PASSCOMP,
 1498.                                .     THEN WRITE A RECORD ISAM TO THE INVOICE DETAIL FILE
 1499.                                . 3.  UPDATE THE CUSTOMER MASTER RECORD WITH THE INVOICE DATA
 1500.                                . 4.  UPDATE THE COMMODITY RECORD
 1501.                                . 5.  UPDATE THE INVENTORY USAGE HISTORY RECORD
 1502.                                . 
 1503.                                . NOW INCLUDE THE   U P D T S Q N C  MODULE  IN-LINE HERE
 1504.                                . 
 1505.                                         INCLUDE   APPUPDSQ.TXT
 1505.    INCLUDE  I: f:\source.cnv\appupdsq.txt



PAGE   37      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

    1. I                              . 
    2. I                              . APPUPDSQ/TXT - 4/30/83
    3. I                              . 
    4. I                              . THIS ROUTINE WILL NOW PRINT THE INVOICE, THEN UPDATE THE ACCOUNTS
    5. I                              . RECEIVABLE MASTER FILE, WITH A RECORD FOR THIS INVOICE!
    6. I                              .
    7. I                              . 
    8. I    0000178A                  PRNTINVC MOVE      "000000.00" TO IAMTPD1
    9. I    00001794                           MOVE      "000000.00" TO IAMTPD2
   10. I    0000179E                           MOVE      "000000.00" TO IAMTPD3
   11. I    000017A8                           MOVE      "000000.00" TO IAMTPD4
   12. I    000017B2                           MOVE      "000000.00" TO IAMTPD5
   13. I    000017BC                           MOVE      "      "    TO ICHK1
   14. I    000017C6                           MOVE      "      "    TO ICHK2
   15. I    000017D0                           MOVE      "      "    TO ICHK3
   16. I    000017DA                           MOVE      "      "    TO ICHK4
   17. I    000017E4                           MOVE      "      "    TO ICHK5
   18. I    000017EE                           MOVE      "      "    TO IDTPD1
   19. I    000017F8                           MOVE      "      "    TO IDTPD2
   20. I    00001802                           MOVE      "      "    TO IDTPD3
   21. I    0000180C                           MOVE      "      "    TO IDTPD4
   22. I    00001816                           MOVE      "      "    TO IDTPD5
   23. I    00001820                           MOVE      "00000000"  TO IPRGDTE
   24. I    0000182A                           MOVE      "0.00"      TO INVTOTL
   25. I    00001834                           MOVE      "0.00"      TO IDOLSLFT
   26. I    0000183E                           MOVE      "0"         TO IPMNTS
   27. I    00001848                           MOVE      INVKEY      TO STARTKEY  (SET THE ISAM ADD KEY)
   28. I    00001852                           MOVE      " "         TO HDRSW
   29. I    0000185C                           MOVE      "0"         TO PAGES
   30. I    00001866                           GOTO      PRNTS
   31. I                              . 
   32. I                              . 
   33. I    0000186C                  BEEPS    BEEP 
   34. I    00001872                           DISPLAY   *P1:24,*HON,"UNABLE TO ADD INVOICE TO A/R FILE!",*W2
   35. I    00001878                           GOTO      BEEPS
   36. I                              . 
   37. I                              . NOW PRINT THE INVOICE
   38. I                              . 
   39. I    0000187E                  PRNTS   
   40. I    0000187E                           SPLOPEN   "LPT1:"
   41. I                               
   42. I    00001888                           CMATCH    "C",INVTYPE
   43. I    00001892                           CALL      HDCREDS IF EQUAL
   44. I                              . 
   45. I    00001898                           CMATCH    "I",INVTYPE
   46. I    000018A2                           CALL      HDINVCS IF EQUAL
   47. I                              . 
   48. I    000018A8                           CMATCH    "H",HDRSW
   49. I    000018B2                           RETURN    IF EQUAL
   50. I    000018B4                           GOTO      DETPRINT
   51. I                              . 
   52. I    000018BA                  HDCREDS  PRINT     *74,"XXXXXXXXXX",*FLUSH
                                                                                *WARNING*
Warning: I/O control not implemented.



PAGE   38      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

   53. I    000018C0                           PRINT     *60,"CREDIT NO.",*75,"A",INVKEY,*FLUSH
                                                                                               *WARNING*
Warning: I/O control not implemented.
   54. I    000018C6                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   55. I    000018CC                           GOTO      ADRPRINT
   56. I                              . 
   57. I    000018D2                  HDINVCS  PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   58. I    000018D8                  NUMBPRNT PRINT     *75,"A",INVKEY,*FLUSH
                                                                              *WARNING*
Warning: I/O control not implemented.
   59. I    000018DE                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   60. I                              . 
   61. I    000018E4                  ADRPRINT PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   62. I    000018EA                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   63. I    000018F0                           PRINT     *8,"ACCT. ",CUSTKEY,*58,"ACCT. ",CUSTKEY,*FLUSH
                                                                                                        *WARNING*
Warning: I/O control not implemented.
   64. I    000018F6                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   65. I    000018FC                           PRINT     *8,CUSTNAME,*55,SHIPNAME,*FLUSH
                                                                                        *WARNING*
Warning: I/O control not implemented.
   66. I    00001902                           PRINT     *8,CUSTADDR,*55,SHIPADDR,*FLUSH
                                                                                        *WARNING*
Warning: I/O control not implemented.
   67. I    00001908                           PRINT     *8,CUSTCITY," ",CUSTSTAT," ",*ZF,CUSTZIP:
   68. I                                                 *55,SHIPADR2,*FLUSH
                                                                            *WARNING*
Warning: I/O control not implemented.
   69. I    0000190E                           PRINT     *8,"ACCOUNTS PAYABLE":
   70. I                                                 *55,SHIPCITY," ",SHIPSTAT," ",SHIPZIP,*FLUSH
                                                                                                     *WARNING*
Warning: I/O control not implemented.
   71. I    00001914                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   72. I    0000191A                           PRINT     *6,INVORDNO,*58,INVORDNO,*FLUSH
                                                                                        *WARNING*
Warning: I/O control not implemented.
   73. I    00001920                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.



PAGE   39      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

   74. I    00001926                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   75. I                              ...................       PRINT     " ",*FLUSH
   76. I                              . 
   77. I    0000192C                           CMATCH    "C",COMPLET
   78. I    00001936                           GOTO      PARTIAL IF NOT EQUAL
   79. I                              . 
   80. I    0000193C                           MOVE      "X" TO PC
   81. I    00001946                           MOVE      " " TO PP
   82. I    00001950                           GOTO      NXTPRNT
   83. I                              . 
   84. I    00001956                  PARTIAL  MOVE      " " TO PC
   85. I    00001960                           MOVE      "X" TO PP
   86. I                              . 
   87. I    0000196A                  NXTPRNT  PRINT     *2,INVORDNO,*17,TODAY,*27,INVWGHT," ",CARTONS:
   88. I                                                 *38,INVSHIP,*57,"2% 15, NET 30",*73,PC,*79,PP,*FLUSH
                                                                                                             *WARNING*
Warning: I/O control not implemented.
   89. I                              . 
   90. I                              ...........................        PRINT     " ",*FLUSH
   91. I    00001970                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
   92. I    00001976                           PRINT     " ",*FLUSH     (19 LINES PRINTED SO FAR!)
                                                                   *WARNING*
Warning: I/O control not implemented.
   93. I    0000197C                           PRINT     " ",*FLUSH     (ADDED 12/16/88 R.B.)
                                                                   *WARNING*
Warning: I/O control not implemented.
   94. I    00001982                           MOVE      "19" TO LINES
   95. I                              . 
   96. I                              . END HEADER PRINT
   97. I                              . 
   98. I    0000198C                           RETURN 
   99. I                              . 
  100. I    0000198E                  DETPRINT MOVE      "0" TO INDX
  101. I    00001998                           MOVE      "1" TO DARECNO
  102. I    000019A2                           MOVE      IRECCNTR TO RECCNTR
  103. I    000019AC                           ADD       "1"      TO RECCNTR
  104. I                              . 
  105. I    000019B2                  DETLOOP  ADD       "1" TO INDX
  106. I    000019B8                           COMPARE   INDX   TO  RECCNTR
  107. I    000019C2                           GOTO      NODETS IF  LESS
  108. I                              . 
  109. I                              . ITS OKAY TO READ, BUT HOW MANY LINES HAVE WE PRINTED?
  110. I                              . 
  111. I                              ....        COMPARE   "42",LINES     (10/27/90 REDUCE TO 40)
  112. I                              .
  113. I    000019C8                           COMPARE   "40",LINES
  114. I                              .
  115. I    000019D2                           CALL      HEADER IF NOT LESS
  116. I                              . 



PAGE   40      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

  117. I                              . 
  118. I    000019D8                           ADD       "1" TO DARECNO
  119. I    000019DE                           READ      DAFILE,DARECNO;INVDTKEY,DTLSTAT,MULTIDSC:
  120. I                                                              INVCKEGS,INVPCSKG,PCSSOLD:
  121. I                                                              LNDOLS,LINECOST,UOM,PRODCODE:
  122. I                                                              FILLER,FILLER2
  123. I                              . 
  124. I    000019E8                           CMATCH    "D",DTLSTAT
  125. I    000019F2                           GOTO      DETLOOP IF EQUAL  (BYPASS DELETED RECORDS)
  126. I                              . 
  127. I    000019F8                           CMATCH    "*",DTLSTAT
  128. I    00001A02                           GOTO      CONTPRNT IF EQUAL
  129. I                              . 
  130. I    00001A08                           PRINT     *3,INVCKEGS,*13,PCSSOLD,*23,INVPCSKG,*33,MULTIDSC:
  131. I                                                 *62,LNDOLS,*71,UOM,*74,LINECOST,*FLUSH
                                                                                               *WARNING*
Warning: I/O control not implemented.
  132. I                              . 
  133. I                              . NOW INCREMENT THE TOTALS
  134. I                              . 
  135. I    00001A0E                           ADD       LINECOST  TO  INVTOTL
  136. I                              . 
  137. I    00001A18                           ADD       "1" TO LINES
  138. I    00001A1E                           GOTO      DETLOOP
  139. I                              . 
  140. I    00001A24                  CONTPRNT PRINT     *34,MULTIDSC
  141. I    00001A2A                           ADD       "1" TO LINES
  142. I    00001A30                           GOTO      DETLOOP
  143. I                              . 
  144. I    00001A36                  HEADER   PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  145. I                              .
  146. I                              .    10/27/90  PRINT TWO MORE BLANK LINES
  147. I                              .
  148. I    00001A3C                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  149. I    00001A42                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  150. I                              ..................................
  151. I    00001A48                           ADD       "1",PAGES
  152. I                              ....         PRINT     *41,"PAGE ",PAGES,*FLUSH
  153. I    00001A4E                           PRINT     *1,"*** PAGE ",PAGES," ***",*FLUSH
                                                                                           *WARNING*
Warning: I/O control not implemented.
  154. I                              .............
  155. I    00001A54                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  156. I    00001A5A                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.



PAGE   41      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

  157. I    00001A60                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  158. I    00001A66                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  159. I    00001A6C                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  160. I    00001A72                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  161. I    00001A78                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  162. I                              . 
  163. I                              . PRINTED  9 BLANK LINES FOR SPACE DOWN TO NEXT INVOICE
  164. I                              . 
  165. I    00001A7E                           MOVE      "H" TO HDRSW
  166. I    00001A88                           CALL      PRNTS
  167. I    00001A8E                           MOVE      " " TO HDRSW
  168. I    00001A98                           RETURN 
  169. I                              . 
  170. I                              . 
  171. I                              ....NODETS   COMPARE   "41",LINES    (10/27/90 STOP AT LINE 39)
  172. I                              .
  173. I    00001A9A                  NODETS   COMPARE   "39",LINES
  174. I    00001AA4                           GOTO      SPCLOOP IF LESS
  175. I    00001AAA                           GOTO      SUBTOTS IF EQUAL
  176. I                              . 
  177. I    00001AB0                  SPCLOOP  PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  178. I    00001AB6                           ADD       "1" TO LINES
  179. I    00001ABC                           GOTO      NODETS
  180. I                              . 
  181. I    00001AC2                  SUBTOTS  MOVE      INVTOTL TO LIBNET
  182. I    00001ACC                           ADD       CALCNET TO LIBNET
  183. I                              .
  184. I                              . 10/27/90  ADD TWO BLANK LINES
  185. I                              .
  186. I    00001AD6                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  187. I    00001ADC                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  188. I                              ..................................................................
  189. I    00001AE2                           PRINT     *75,INVTOTL,*FLUSH
                                                                           *WARNING*
Warning: I/O control not implemented.
  190. I    00001AE8                           PRINT     *75,CALCNET,*FLUSH
                                                                           *WARNING*
Warning: I/O control not implemented.



PAGE   42      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

  191. I    00001AEE                           PRINT     *74,LIBNET,*FLUSH
                                                                          *WARNING*
Warning: I/O control not implemented.
  192. I    00001AF4                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  193. I                              . 
  194. I    00001AFA                           MOVE      LIBNET TO INVTOTL
  195. I    00001B04                           ADD       INVTOTL TO REPNET
  196. I    00001B0E                           MOVE      INVTOTL TO IDOLSLFT
  197. I                              . 
  198. I    00001B18                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  199. I                              ....         PRINT     " ",*FLUSH
  200. I    00001B1E                           PRINT     *24,"ISO-9002 CERTIFIED"
  201. I    00001B24                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  202. I    00001B2A                           PRINT     *15," ",*FLUSH
                                                                       *WARNING*
Warning: I/O control not implemented.
  203. I    00001B30                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  204. I    00001B36                           PRINT     " ",*FLUSH
                                                                   *WARNING*
Warning: I/O control not implemented.
  205. I                              .
  206. I                              .   4-23-2004   ADD SPLCLOSE TO FORCE PRINT OF DOCUMENT
  207. I                              .
  208. I    00001B3C                           SPLCLOSE 
  209. I                              .
  210. I                              .
  211. I                               
  212. I                               
  213. I                              . 
  214. I                              .  ADD THE A/R RECORD
  215. I                              . 
  216. I    00001B3E                           TRAPCLR   IO
  217. I    00001B44                           TRAP      BEEPS IF IO
  218. I                              . 
  219. I    00001B52                           CALL      ADDRCVB
  220. I    00001B58                           CMATCH    "H",IOSW
  221. I    00001B62                           GOTO      BEEPS IF NOT EQUAL
  222. I                              . 
  223. I                              . NOW INSERT THE KEY IN THE ARFILEXX/ISI FILE
  224. I                              . 
  225. I    00001B68                           CLEAR     INSERTKY
  226. I    00001B6E                           APPEND    CUSTKEY TO INSERTKY
  227. I    00001B78                           APPEND    INVTYPE TO INSERTKY
  228. I    00001B82                           APPEND    INVKEY  TO INSERTKY
  229. I    00001B8C                           RESET     INSERTKY   TO 1



PAGE   43      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

  230. I    00001B96                           REP       " 0"    IN INSERTKY
  231. I                              . 
  232. I    00001BA0                           INSERT    INSERTFL,INSERTKY
  233. I                              . 
  234. I                              . NOW INSERT THE KEY IN THE ARFILEDT/ISI FILE
  235. I                              . 
  236. I    00001BAA                           CLEAR     ARFLDTKY
  237. I    00001BB0                           APPEND    XYY TO ARFLDTKY
  238. I    00001BBA                           APPEND    XMM TO ARFLDTKY
  239. I    00001BC4                           APPEND    XDD TO ARFLDTKY
  240. I    00001BCE                           APPEND    INVKEY TO ARFLDTKY
  241. I    00001BD8                           RESET     ARFLDTKY  TO 1
  242. I                              . 
  243. I    00001BE2                           INSERT    ARFILEDT,ARFLDTKY
  244. I                              . 
  245. I    00001BEC                           CLEAR     NEWFKEY
  246. I    00001BF2                           APPEND    INVKEY TO NEWFKEY
  247. I    00001BFC                           RESET     NEWFKEY TO 1
  248. I    00001C06                           MOVE      INVKEY TO NINVCNO
  249. I    00001C10                           WRITE     NEWFILE,NEWFKEY;NINVCNO
  250. I                              .
  251. I                              .................................................
  252. I                              . 
  253. I                              . 
  254. I                              . NOW UPDATE THE CUSTOMER AND CONTROLS FILES
  255. I                              . 
  256. I    00001C1A                           GOTO      CUSTUPDS
  257. I                              . 
  258. I                              ..........................................................
 1506.                                . 
 1507.                                . 
 1508.                                . THE FOLLOWING ROUTINE IS USED TO PERMIT REVIEW/CORRECTION/DELETION
 1509.                                . OF DETAIL ITEMS ON THIS INVOICE, IN THE EVENT THAT THE DATA ENTRY
 1510.                                . CLERK INDICATES THAT THE INVOICE IS IN ERROR OR IN QUESTION!
 1511.                                . 
 1512.                                . NOTE THAT AN OPTION IS OFFERED WHICH PERMITS THE OPERATOR TO 
 1513.                                . COMPLETELY  C A N C E L  THIS INVOICE ENTRY,  WHICH WILL CAUSE
 1514.                                . THE INVOICE HEADER TO BE UPDATED WITH A "CANCEL CODE".
 1515.                                . THE CANCEL CODE MAY BE USED TO TRIGGER AN EXCEPTION LISTING WITH
 1516.                                . ALL CANCELED INVOICE NUMBERS.
 1517.                                . 
 1518.      00001C20                  REVIEWIT TRAPCLR   PARITY                (NOW DISPLAY/MODIFY/CORRECT DATA)
 1519.      00001C26                           DISPLAY   *ES,*P01:02,"THE REVIEW FUNCTION WILL DISPLAY TO YOU ":
 1520.                                                               "ALL THE DATA YOU HAVE KEYED":
 1521.                                                       *P01:04,"YOU WILL BE ABLE TO MAKE THE FOLLOWING ":
 1522.                                                               "CHANGES............":
 1523.                                                       *P01:06,"     - CANCEL THE INVOICE":
 1524.                                                       *P01:07,"     - CHANGE THE GROSS WEIGHT":
 1525.                                                       *P01:08,"     - CHANGE THE FREIGHT RATE":
 1526.                                                       *P01:09,"     - ADD    DETAIL LINES":
 1527.                                                       *P01:10,"     - DELETE DETAIL LINES":
 1528.                                                       *P01:11,"     - MODIFY DETAIL LINES"
 1529.      00001C2C                  REVQUES  KEYIN     *P01:14,*EF,*P01:14,"DO YOU WISH TO REVIEW (H)eader or ":



PAGE   44      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1530.                                                           "(D)etail DATA ?  ",REPLY
 1531.      00001C32                           CMATCH    "H",REPLY
 1532.      00001C3C                           GOTO      REVHDRS IF EQUAL
 1533.      00001C42                           CMATCH    "D",REPLY
 1534.                                .
 1535.                                ....        GOTO      REVWDTLS IF EQUAL
 1536.                                .
 1537.      00001C4C                           GOTO      REVHDRS IF EQUAL
 1538.      00001C52                           BEEP 
 1539.      00001C58                           MOVE      " ",REPLY
 1540.      00001C62                           GOTO      REVQUES
 1541.                                . 
 1542.      00001C68                  REVWDTLS TRAPCLR   PARITY
 1543.                                . 
 1544.      00001C6E                           DISPLAY   *ES,*P22:01,"INVOICE DETAIL CORRECTION OPTION":
 1545.                                                       "     Today is ",TODAY
 1546.      00001C74                           CALL      GTRCZRO
 1547.      00001C7A                           MOVE      IRECCNTR  TO  RECCNTR
 1548.      00001C84                           ADD       "1"       TO  RECCNTR
 1549.                                . 
 1550.      00001C8A                  REVDTLS  SUBTRACT  "1"     FROM  RECCNTR
 1551.      00001C90                           COMPARE   "0"       TO  RECCNTR
 1552.      00001C9A                           GOTO      ADDMORE  IF  EQUAL
 1553.                                . 
 1554.      00001CA0                           READ      DAFILE,RECCNTR;INVDTKEY,DTLSTAT,MULTIDSC,INVCKEGS:
 1555.                                                                  INVPCSKG,PCSSOLD,LNDOLS,LINECOST:
 1556.                                                                  UOM,PRODCODE,FILLER,FILLER2
 1557.      00001CAA                           CMATCH    "D",DTLSTAT
 1558.      00001CB4                           GOTO      REVDTLS IF EQUAL
 1559.                                . 
 1560.                                . BYPASS PREVIOUSLY DELETED ITEM.....DO NOT DISPLAY
 1561.                                . 
 1562.                                . CALCULATED THE EXTENDED PRICE FOR DISPLAY
 1563.                                . 
 1564.      00001CBA                           MOVE      INVCKEGS  TO  KEGSORD
 1565.      00001CC4                           MOVE      PCSSOLD   TO  PCSORD
 1566.      00001CCE                           MOVE      LNDOLS    TO  LINEPRC
 1567.                                . 
 1568.                                . ........THE ABOVE SETS UP THE EXTEND MODULE
 1569.                                . 
 1570.                                . 
 1571.      00001CD8                  SHOWMODS DISPLAY   *P01:06,*EF:
 1572.                                                   *P01:08,"PART NUMBER",*P20:08,MULTIDSC:
 1573.                                                   *P01:09,"QTY ORDERED ",*P20:09,INVCKEGS:
 1574.                                                   *P01:10,"QTY SHIPPED  ",*P20:10,PCSSOLD:
 1575.                                                   *P01:11,"QTY BACKORD  ",*P20:11,INVPCSKG:
 1576.                                                   *P01:12,"PRICE PER UOM",*P20:12,LNDOLS:
 1577.                                                   *P01:13,"EXTENDED PRICE",*P20:13,LINECOST:
 1578.                                                   *P01:14,"PRODUCT CODE",*P20:14,PRODCODE:
 1579.                                                   *P01:15,"UNIT OF MEASURE",*P20:15,UOM
 1580.                                ..............................................................
 1581.      00001CDE                           MOVE      LINECOST  TO  OLDXTEND     (SAVE THE EXTENDED SELLING PRICE)
 1582.                                . ................................................................



PAGE   45      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1583.                                . 
 1584.      00001CE8                  BUMANSR1 MOVE      " "  TO  REPLY
 1585.      00001CF2                           KEYIN     *P01:24,*EL,"DO YOU WANT TO CHANGE or DELETE THIS ITEM ? ":
 1586.                                                               "(Y/N) ",REPLY
 1587.      00001CF8                           CMATCH    "Y",REPLY
 1588.      00001D02                           GOTO      KEYDTLMD  IF  EQUAL
 1589.      00001D08                           CMATCH    "N",REPLY
 1590.      00001D12                           GOTO      BUMANSR1 IF NOT EQUAL
 1591.                                . 
 1592.                                . FALLTHRU MEANS NO! DONT CHANGE IT OR DELETE IT!
 1593.                                . 
 1594.      00001D18                  EXPLAIN  MOVE      " " TO REPLY
 1595.      00001D22                           KEYIN     *P01:24,*EL,"YOU MAY NOT ADD DETAILS UNTIL YOU`VE SEEN ALL":
 1596.                                                           " THAT EXIST - (TAP ENTER) ",REPLY
 1597.                                . 
 1598.      00001D28                  SEEMRDT  MOVE      " " TO REPLY
 1599.      00001D32                           KEYIN     *P01:24,*EL,"DO YOU WANT TO SEE MORE DETAILS ? (Y/N) ":
 1600.                                                   REPLY
 1601.      00001D38                           CMATCH    "Y",REPLY
 1602.      00001D42                           GOTO      REVDTLS IF EQUAL
 1603.      00001D48                           CMATCH    "N",REPLY
 1604.      00001D52                           GOTO      EXPLAIN IF NOT EQUAL
 1605.                                .
 1606.                                . FALLTHRU MEANS I HAVE MADE MY CORRECTIONS AND WANT TO REPROVE
 1607.                                . 
 1608.      00001D58                           DISPLAY   *P01:24,*EL,"OKAY....I WILL NOW PROVE THIS INVOICE ",*W2
 1609.      00001D5E                           GOTO      SHOWTOTS
 1610.                                .......................................................................
 1611.                                . 
 1612.      00001D64                  ADDMORE  MOVE      " " TO REPLY
 1613.      00001D6E                           BEEP 
 1614.      00001D74                           KEYIN     *P01:24,*EL,"DO YOU WANT TO   A D D  MORE DETAILS ? (Y/N) ":
 1615.                                                   REPLY
 1616.      00001D7A                           CMATCH    "Y",REPLY
 1617.      00001D84                           GOTO      SETUPADD IF EQUAL
 1618.      00001D8A                           CMATCH    "N",REPLY
 1619.      00001D94                           GOTO      ADDMORE IF NOT EQUAL
 1620.      00001D9A                           GOTO      FINIDTLS
 1621.                                . 
 1622.                                . 
 1623.      00001DA0                  SETUPADD MOVE      INVLINES TO IRECCNTR
 1624.      00001DAA                           MOVE      INVLINES TO RECCNTR
 1625.      00001DB4                           MOVE      INVLINES TO ILIVCNTR
 1626.      00001DBE                           GOTO      RECYCLE               (THIS WILL ALLOW ADDS)
 1627.                                . 
 1628.                                . .......................................................................
 1629.                                . 
 1630.                                . R E P R O V E .........NOTE THIS MUST FIRST ACCESS THE EXISTING DETAILS
 1631.                                .                        DO MULTIPLE EXTENSIONS AND VERIFY THAT ALL IS OKAY
 1632.                                . 
 1633.      00001DC4                  REPROVE  RETURN 
 1634.                                . 
 1635.      00001DC6                  RECALC   GOTO      UPDTSEQ



PAGE   46      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1636.                                . 
 1637.                                . ............................................................................
 1638.                                . 
 1639.      00001DCC                  KEYDTLMD MOVE      " "  TO  REPLY
 1640.      00001DD6                           KEYIN     *P01:24,*EL,"D E L E T E  THIS ITEM ?  (Y/N)  ",REPLY
 1641.      00001DDC                           CMATCH    "Y",REPLY
 1642.      00001DE6                           GOTO      DELIT IF EQUAL
 1643.      00001DEC                           CMATCH    "N",REPLY
 1644.      00001DF6                           GOTO      KD1 IF EQUAL
 1645.      00001DFC                           BEEP 
 1646.      00001E02                           GOTO      KEYDTLMD
 1647.                                . 
 1648.      00001E08                  DELIT    MOVE      "D"  TO  DTLSTAT
 1649.      00001E12                           DISPLAY   *P01:24,*EL,"LINE ITEM HAS BEEN DELETED",*W2
 1650.      00001E18                           SUBTRACT  OLDXTEND FROM TOTDOLS      (ADJUST THE TOTALS)
 1651.      00001E22                           MOVE      TOTDOLS  TO   INVTOTL
 1652.      00001E2C                           MOVE      TOTDOLS  TO   IDOLSLFT
 1653.      00001E36                           GOTO      PUTDTLBK
 1654.                                . 
 1655.      00001E3C                  KD1      KEYIN     *P01:24,"PLEASE MAKE YOUR CHANGES !":
 1656.                                                   *P20:09,*RV,INVCKEGS:
 1657.                                                   *P20:10,*RV,PCSSOLD:
 1658.                                                   *P20:11,*RV,INVPCSKG:
 1659.                                                   *P20:12,*RV,LNDOLS:
 1660.                                                   *P20:14,*RV,PRODCODE:
 1661.                                                   *P20:15,*RV,UOM
 1662.                                . 
 1663.      00001E42                           MOVE      PCSSOLD   TO  PCSORD
 1664.      00001E4C                           MOVE      INVCKEGS  TO  KEGSORD
 1665.      00001E56                           MOVE      LNDOLS    TO  LINEPRC
 1666.      00001E60                           MOVE      "X"       TO  DTLSTAT
 1667.                                . 
 1668.      00001E6A                           MOVE      PCSSOLD  TO  CALCNET
 1669.      00001E74                           MULTIPLY  LNDOLS   BY  CALCNET
 1670.                                . 
 1671.      00001E7E                           CMATCH    "C",UOM
 1672.      00001E88                           GOTO      CHKZM    IF  NOT  EQUAL
 1673.      00001E8E                           DIVIDE    "100"  INTO  CALCNET
 1674.      00001E98                           GOTO      KD1Z
 1675.                                . 
 1676.      00001E9E                  CHKZM    CMATCH    "M",UOM
 1677.      00001EA8                           GOTO      KD1Z IF  NOT  EQUAL                                        
 1678.      00001EAE                           DIVIDE    "1000" INTO  CALCNET
 1679.                                . 
 1680.      00001EB8                  KD1Z     MOVE      CALCNET  TO  LINECOST
 1681.                                . 
 1682.                                . 
 1683.                                . NOW DO A CHECK OF THE EXTEND CALCULATION   (3/13/82)
 1684.                                . TO SEE IF YOU HAVE THROWN OFF THE TOTAL!
 1685.                                . 
 1686.      00001EC2                           COMPARE   OLDXTEND TO  LINECOST
 1687.      00001ECC                           GOTO      XTENDOK  IF  EQUAL
 1688.                                . 



PAGE   47      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1689.                                . FALLTHRU MEANS THAT A PRICE WAS CHANGED!  (ie. UNEQUAL EXTENDED LINE PRICES)
 1690.                                . 
 1691.      00001ED2                           SUBTRACT  OLDXTEND FROM TOTDOLS
 1692.      00001EDC                           ADD       LINECOST TO   TOTDOLS
 1693.      00001EE6                           MOVE      TOTDOLS  TO   INVTOTL
 1694.      00001EF0                           MOVE      TOTDOLS  TO   IDOLSLFT
 1695.                                . 
 1696.                                . THEREFORE EXECUTE THE TWO INSTRUCTIONS ABOVE AND FIX THE TOTALS!
 1697.                                . 
 1698.      00001EFA                  XTENDOK  DISPLAY   *P20:09,INVCKEGS:
 1699.                                                   *P20:10,INVPCSKG:
 1700.                                                   *P20:11,PCSSOLD:
 1701.                                                   *P20:12,LNDOLS:
 1702.                                                   *P20:13,LINECOST
 1703.                                . 
 1704.      00001F00                  KD2      MOVE      " ",REPLY
 1705.      00001F0A                           KEYIN     *P01:24,*EL,"IS THE DATA CORRECT NOW ? (Y/N) ",REPLY
 1706.      00001F10                           CMATCH    "Y",REPLY
 1707.      00001F1A                           GOTO      KD3  IF  EQUAL
 1708.      00001F20                           BEEP 
 1709.      00001F26                           DISPLAY   *P01:24,*EL
 1710.      00001F2C                           GOTO      KD1
 1711.                                . 
 1712.      00001F32                  KD3      MOVE      "X"  TO  DTLSTAT         (MUST CHECK THE KEGS AVAILABLE)
 1713.                                . 
 1714.      00001F3C                           DISPLAY   *P01:24,*EL
 1715.      00001F42                  PUTDTLBK WRITE     DAFILE,RECCNTR;INVDTKEY,DTLSTAT,MULTIDSC,INVCKEGS:
 1716.                                                                  INVPCSKG,PCSSOLD,LNDOLS,LINECOST:
 1717.                                                                  UOM,PRODCODE,FILLER,FILLER2
 1718.      00001F4C                           GOTO      REVDTLS
 1719.                                . 
 1720.      00001F52                  FINIDTLS BEEP 
 1721.      00001F58                           DISPLAY   *ES,*P01:10,"YOU HAVE SEEN ALL THE CURRENTLY EXISTING":
 1722.                                                               " DETAILS FOR THIS INVOICE ":
 1723.                                                       *P01:14,"THE INVOICE TOTAL WILL NOW BE COMPLETELY ":
 1724.                                                               "RECALCULATED",*W1
 1725.      00001F5E                           GOTO      SHOWTOTS       (3/13/82 VICE RECALC)
 1726.                                . 
 1727.                                . 
 1728.                                . 
 1729.      00001F64                  REVHDRS  CALL      GTRCZRO
 1730.                                . 
 1731.      00001F6A                  HDRMOD   DISPLAY   *ES,*P20:01,"INVOICE HEADER CORRECTION":
 1732.                                                       *P10:03,"PLEASE TAP THE ENTER KEY TO TAB PAST":
 1733.                                                       " ANY DATA WHICH IS CORRECT":
 1734.                                                       *P17:04,"RE-KEY ANY INCORRECT DATA AND TAP ENTER"
 1735.      00001F70                  HDRDISP  MOVE      "INVOICE"  TO  DTYPE
 1736.      00001F7A                           CMATCH    "C"  TO  INVTYPE
 1737.      00001F84                           GOTO      TYPEOK   IF  NOT  EQUAL
 1738.      00001F8A                           MOVE      "CREDIT "  TO  DTYPE
 1739.      00001F94                  TYPEOK   MOVE      INVCUST    TO  CUSTKEY
 1740.      00001F9E                           CALL      GETCUST
 1741.      00001FA4                           CMATCH    "H",IOSW



PAGE   48      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1742.      00001FAE                           GOTO      GOTCUST  IF  EQUAL
 1743.      00001FB4                           MOVE      "INVALID ACCOUNT NUMBER"  TO  CUSTNAME
 1744.      00001FBE                  GOTCUST  MOVE      "OPEN"   TO  DSTAT
 1745.      00001FC8                           CMATCH    "C"      TO  INVSTAT
 1746.      00001FD2                           GOTO      DDISP  IF  NOT  EQUAL
 1747.      00001FD8                           MOVE      "CANCELLED"  TO  DSTAT
 1748.                                . 
 1749.      00001FE2                  DDISP    DISPLAY   *P10:06,DTYPE,"NUMBER  ",*P26:06,INVKEY:
 1750.                                                   *P10:07,"ACCOUNT  ",INVCUST,*P26:07,CUSTNAME:
 1751.                                                   *P10:09,"WEIGHT IS ",*P26:09,INVWGHT:
 1752.                                                   *P10:10,"CARTONS   ",*P26:10,CARTONS:
 1753.                                                   *P10:11,"PO NUMBER ",*P26:11,INVORDNO
 1754.                                . 
 1755.                                . 
 1756.                                . NOW ACCEPT ANY CHANGES
 1757.                                . 
 1758.                                . 
 1759.      00001FE8                  HKEYIN   KEYIN     *P26:09,*RV,INVWGHT:
 1760.                                                   *P26:10,*RV,CARTONS:
 1761.                                                   *P26:11,*RV,INVORDNO
 1762.                                . 
 1763.      00001FEE                           DISPLAY   *P26:09,INVWGHT:
 1764.                                                   *P26:10,CARTONS:
 1765.                                                   *P26:11,INVORDNO
 1766.                                . 
 1767.                                . DETERMINE IF CHANGES HAVE BEEN MADE TO FRGTRATE OR INVWGHT
 1768.                                . 
 1769.      00001FF4                           MOVE      " "  TO  HDRCHGSW
 1770.                                . 
 1771.      00001FFE                  HKYN1    MOVE      " " TO REPLY
 1772.      00002008                           KEYIN     *P01:24,"DO YOU WISH TO CANCEL THIS INVOICE ? ":
 1773.                                                           " (Y/N) ",REPLY
 1774.      0000200E                           CMATCH    "Y",REPLY
 1775.      00002018                           GOTO      HDRCNCL IF EQUAL
 1776.      0000201E                           CMATCH    "N",REPLY
 1777.      00002028                           GOTO      NXT1 IF EQUAL
 1778.      0000202E                           BEEP 
 1779.      00002034                           GOTO      HKYN1
 1780.                                . 
 1781.      0000203A                  HDRCNCL  MOVE      "C"  TO  INVSTAT
 1782.      00002044                           CMATCH    "L",INVCOMP
 1783.      0000204E                           GOTO      SUBREP  IF NOT EQUAL
 1784.      00002054                           SUBTRACT  TOTDOLS FROM LIBNET
 1785.      0000205E                           GOTO      HCLZERO
 1786.      00002064                  SUBREP   SUBTRACT  TOTDOLS FROM REPNET
 1787.      0000206E                  HCLZERO  MOVE      "0"  TO  TOTDOLS
 1788.      00002078                           MOVE      "0"  TO  INVTOTL
 1789.      00002082                           MOVE      "0"  TO  IDOLSLFT
 1790.      0000208C                           MOVE      "0"  TO  IRECCNTR
 1791.      00002096                           MOVE      "0"  TO  ILIVCNTR
 1792.      000020A0                           MOVE      "0"  TO  RECCNTR
 1793.      000020AA                           MOVE      "CANCELED BY DATA ENTRY OPERATOR" TO INVMESG
 1794.      000020B4                           CALL      WRTHDRIS



PAGE   49      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1795.      000020BA                           GOTO      ENDREPLY
 1796.                                . 
 1797.                                . 
 1798.                                . NOTE AT THIS TIME.... I F   WE DONT WANT TO DO MORE
 1799.                                . 
 1800.                                .  WE  C O U L D  EXECUTE A PREPARE, FOLLOWED BY A CLOSE
 1801.                                .  TO PHYSICALLY DELETE THIS DATA ENTRY BATCH FILE
 1802.                                . 
 1803.                                . NOTE.....SINCE WE HAVE SAVED THE OLD FREIGHT ALLOWANCE (IF ANY)
 1804.                                .          AND SINCE WE ARE USING  *RV  FUNCTION ON THOSE FIELDS
 1805.                                .          THEN WE CAN    I N C R E M E N T  THE TOTDOLS
 1806.                                .          FIELD  BY OLDFRGT  (REMOVING THE FREIGHT ALLOWANCE)
 1807.                                .          AND THEN ..... D E C R E M E N T  THE TOTDOLS
 1808.                                .          FIELD  USING THE CALCDATA ROUTINE........
 1809.                                . 
 1810.                                .  THIS WILL WORK EVEN IF WE  D I D N ` T  CHANGE THE VALUES !
 1811.                                . 
 1812.                                . ...............................................................
 1813.                                . NOTE    THE CALCDATA ROUTINE ACCESSES  THE  TOTDOLS FIELD
 1814.                                .         FOR ITS CALCULATIONS....SO ONLY INCREMENT   TOTDOLS
 1815.                                . 
 1816.                                . NOW DETERMINE IF THE HEADER VALUES HAD BEEN CHANGED!
 1817.                                . 
 1818.      000020C0                  NXT1     GOTO      NOCHNGS
 1819.      000020C6                  NOCHNGS  CALL      PTRCZRO         (WRITE IT NOW NOT BEFORE 3/13)
 1820.      000020CC                           GOTO      SHOWTOTS        (GO BACK AND VIEW THE RESULTS !)
 1821.                                . 
 1822.                                . NOW UPDATE ALL NECESSARY FILES WITH THE DOLLAR INFORMATION
 1823.                                . 
 1824.      000020D2                  CUSTUPDS MOVE      PASSACCT  TO  CUSTKEY
 1825.      000020DC                           CALL      GETCUST
 1826.      000020E2                           CMATCH    "H"       TO  IOSW
 1827.      000020EC                           GOTO      ADDCUST   IF  EQUAL
 1828.      000020F2                           BEEP 
 1829.      000020F8                           DISPLAY   *P01:24,"CANNOT FIND THE CUSTOMER RECORD TO UPDATE SALES"
 1830.      000020FE                           GOTO      CTRLUPDT
 1831.      00002104                  ADDCUST  ADD       TOTDOLS   TO  CURNTDUE
 1832.      0000210E                           MOVE      TOTDOLS   TO  LSTSALPR
 1833.      00002118                           MOVE      INVDATE   TO  LSTSALDT
 1834.      00002122                           CALL      PUTCUST
 1835.                                . 
 1836.                                . CUSTOMER HAS BEEN UPDATED WITH DOLLAR INFORMATION
 1837.                                . 
 1838.      00002128                  CTRLUPDT CMATCH    "A"       TO  PASSCOMP
 1839.      00002132                           GOTO      REPCTLS   IF  NOT  EQUAL
 1840.      00002138                           MOVE      "APP"     TO  CTLKEY
 1841.                                .
 1842.      00002142                  PROCCTL  TRAPCLR   IO
 1843.      00002148                           TRAP      NOCTLSFD IF IO
 1844.      00002156                           CMOVE     "M" TO IOSW
 1845.      00002160                           FILEPI    19;CONTROLS
 1846.      0000216A                           CALL      GETCTL
 1847.      00002170                           CMATCH    "H"       TO  IOSW



PAGE   50      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1848.      0000217A                           GOTO      NOCTLSFD  IF  NOT EQUAL
 1849.                                .
 1850.      00002180                           ADD       TOTDOLS   TO  CTLSOLD
 1851.      0000218A                           MOVE      TODAY     TO  CTLDATE
 1852.      00002194                           CMOVE     "M",IOSW
 1853.      0000219E                           CALL      PUTCTL
 1854.      000021A4                           FILEPI    0
 1855.                                .
 1856.      000021AE                           CMATCH    "H",IOSW
 1857.      000021B8                           GOTO      BUMCTLWT IF NOT EQUAL
 1858.                                . .
 1859.                                . CONTROLS HAVE BEEN UPDATED
 1860.      000021BE                           GOTO      ENDREPLY
 1861.                                .
 1862.      000021C4                  BUMCTLWT BEEP 
 1863.      000021CA                           DISPLAY   *P1:23,*EL,"UNABLE TO UPDATE CONTROLS FILE",*W3
 1864.      000021D0                           DISPLAY   *P1:23,*EL
 1865.      000021D6                           GOTO      ENDREPLY
 1866.                                . 
 1867.                                . 
 1868.      000021DC                  NOCTLSFD BEEP 
 1869.      000021E2                           DISPLAY   *P01:24,"NO CONTROLS RECORD ...... WHATS HAPPENING?"
 1870.      000021E8                           GOTO      NOCTLSFD
 1871.                                . 
 1872.                                . 
 1873.      000021EE                  REPCTLS  MOVE      "APP"     TO  CTLKEY
 1874.      000021F8                           GOTO      PROCCTL
 1875.                                . 
 1876.      000021FE                  ENDREPLY BEEP 
 1877.                                . 
 1878.                                . NOW DISPLAY SAME AS SHOWTOTS PARAGRAPH BUT NO MORE RETRIES
 1879.                                . 
 1880.      00002204                           DISPLAY   *ES,*P01:12,"INVOICE NUMBER ",INVKEY," TOTAL NET ":
 1881.                                                               "INVOICE IS: $",TOTDOLS:
 1882.                                                       *P01:14,"NET INCLUDES A DEDUCTED FREIGHT ALLOWANCE":
 1883.                                                               " OF $",FRTALLOW
 1884.                                . 
 1885.      0000220A                           MOVE      "00"  TO  INVLINES
 1886.      00002214                           MOVE      "0"   TO  TOTDOLS
 1887.      0000221E                           MOVE      "0"   TO  FRTALLOW
 1888.                                . 
 1889.                                . 
 1890.                                .  5/18/83 - MODIFICATION:
 1891.                                . 
 1892.                                . SINCE INVOICE IS COMPLETE AND TROUBLES HAVE BEEN EXPERIENCED WITH
 1893.                                . THE RETENTION OF THE DATA ENTRY FILE, PURGE IT HERE AND REOPEN IT,
 1894.                                . IF NECESSARY FOR NEW DATA
 1895.                                . 
 1896.                                . ALSO CLEAR THE MULTIPLE DESCRIPTION FIELD
 1897.                                . 
 1898.                                ....................        PREPARE   DAFILE,DANAME
 1899.                                .
 1900.      00002228                           CLOSE     DAFILE            (THIS PURGES/KILLS THE DATA FILE)



PAGE   51      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

 1901.                                .
 1902.                                . 
 1903.      00002232                  CLEARMOV MOVE      "0" TO MULTICNT
 1904.      0000223C                           MOVE      "0" TO RECCNTR
 1905.      00002246                           MOVE      "0" TO ILIVCNTR
 1906.      00002250                           MOVE      "0" TO IRECCNTR
 1907.      0000225A                           MOVE      " " TO MULTIFLG
 1908.      00002264                           MOVE      " " TO MD1
 1909.      0000226E                           MOVE      " " TO MD2
 1910.      00002278                           MOVE      " " TO MD3
 1911.      00002282                           MOVE      " " TO MD4
 1912.      0000228C                           MOVE      " " TO MD5
 1913.      00002296                           MOVE      " " TO MD6
 1914.      000022A0                           MOVE      " " TO MD7
 1915.      000022AA                           MOVE      " " TO MD8
 1916.      000022B4                           MOVE      " " TO MD9
 1917.      000022BE                           MOVE      " " TO MD10
 1918.                                .......................................................................
 1919.                                . 
 1920.      000022C8                           KEYIN     *P01:16,*EF,"DO YOU HAVE ANY MORE INVOICES TO ADD":
 1921.                                                               " AT THIS TIME ?  (Y)es or (N)o  ",REPLY
 1922.      000022CE                           CMATCH    "Y" TO REPLY
 1923.      000022D8                           GOTO      CHAINHDR IF EQUAL
 1924.      000022DE                           CMATCH    "N" TO REPLY
 1925.      000022E8                           GOTO      TAPTERM IF EQUAL
 1926.                                .
 1927.      000022EE                          BEEP 
 1928.      000022F4                          GOTO       CLEARMOV
 1929.                                .
 1930.      000022FA                  TAPTERM  DISPLAY   *ES,*P01:12,"TOTAL INVOICE NET -   ",REPNET
 1931.      00002300                           BEEP 
 1932.      00002306                           KEYIN     *P01:20,"PRESS ENTER TO TERMINATE THIS PROGRAM",KREPLY
 1933.                                . 
 1934.      0000230C                           RELEASE 
 1935.                                .
 1936.                                . 
 1937.                                . ............................................................
 1938.      0000230E                           CHAIN     "APPINVC1"
 1939.                                . 
 1940.      00002314                  CHAINHDR PREPARE   DAFILE,DANAME (NOW PREPARE THE DATA FILE AGAIN)
 1941.      00002322                           GOTO      WHATKIND      (GO BACK TO THE INVOICE HEADER ENTRY)
 1942.                                . 
 1943.                                . 
 1944.                                . 
 1945.      00002328                  NOINVOIC  BEEP 
 1946.      0000232E                           DISPLAY   *ES,*P01:12,"DISK IO ERROR ON ORDER TOTAL UPDATE":
 1947.                                                       *N,"SERIOUS PROBLEM, CALL BOB BACHARACH, MSC":
 1948.                                                       *N,"516-698-5577",*W,*W,*W
 1949.      00002334                           GOTO      NOINVOIC
 1950.                                . 
 1951.                                . 
 1952.                                         INCLUDE   CONTRLIO.TXT
 1952.    INCLUDE  J: f:\source\contrlio.txt



PAGE   52      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

    1. J                              + 
    2. J                              .....................................................................
    3. J                              .   CONTRLIO = CORPORATE CONTROL I/O MODULE        (VOLID MSC 6)
    4. J                              . 
    5. J                              .   THIS MODULE REQUIRES THAT MODULE  - CONTFILE - (VOLID MSC 6)
    6. J                              .   ALSO BE INCLUDED IN THE PROGRAM WORK AREA
    7. J                              .....................................................................
    8. J                              . 
    9. J    0000233A                  OPENCTLS TRAPCLR   IO
   10. J    00002340                           TRAP      NOCTLS IF IO
   11. J    0000234E                           OPEN      CONTROLS,CTLNAME          OPEN THE ISAM FILE
   12. J    0000235C                           RETURN 
   13. J                              . 
   14. J    0000235E                  GETCTL   TRAPCLR   IO
   15. J    00002364                           TRAP      NOCTLS IF IO
   16. J    00002372                           READ      CONTROLS,CTLKEY;CTLKEY:
   17. J                                                                 CTLDATE:
   18. J                                                                 CTLINVC:
   19. J                                                                 CTLPONO:
   20. J                                                                 CTLRCVD:
   21. J                                                                 CTLSOLD:
   22. J                                                                 CTLCASH:
   23. J                                                                 CTLMRCVD:
   24. J                                                                 CTLMSOLD:
   25. J                                                                 CTLMCASH:
   26. J                                                                 CTLYRCVD:
   27. J                                                                 CTLYSOLD:
   28. J                                                                 CTLYCASH
   29. J    0000237C                           GOTO      NOCTLS IF OVER
   30. J                              . 
   31. J    00002382                           MOVE      "H"    TO IOSW
   32. J    0000238C                  CTLRTRN  RETURN 
   33. J                              . 
   34. J    0000238E                  NOCTLS   BEEP 
   35. J    00002394                           DISPLAY   *ES,*P01:12,"ERROR IN CORPORATE CONTROLS FILE ":
   36. J                                                             " I/O - JOB ABORTING",*W,*W,*W
   37. J    0000239A                           BEEP 
   38. J    000023A0                           STOP 
   39. J                              . 
   40. J    000023A2                  PUTCTL   TRAPCLR   IO
   41. J    000023A8                           TRAP      NOCTLS IF IO
   42. J    000023B6                           UPDATE    CONTROLS;CTLKEY:
   43. J                                                          CTLDATE:
   44. J                                                          CTLINVC:
   45. J                                                          CTLPONO:
   46. J                                                          CTLRCVD:
   47. J                                                          CTLSOLD:
   48. J                                                          CTLCASH:
   49. J                                                          CTLMRCVD:
   50. J                                                          CTLMSOLD:
   51. J                                                          CTLMCASH:
   52. J                                                          CTLYRCVD:
   53. J                                                          CTLYSOLD:



PAGE   53      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

   54. J                                                          CTLYCASH
   55. J    000023C0                           MOVE      "H" TO IOSW
   56. J    000023CA                           GOTO      CTLRTRN                 UPDATE SUCCESSFUL
   57. J    000023D0                           RETURN 
                                                     *WARNING*
Warning: Statement has no label and follows unconditional goto.
   58. J                              . 
   59. J                              . 
   60. J                              .  END OF CONTROL I/O MODULE
   61. J                              . 
   62. J                              . 
 1953.                                . 
 1954.                                . 
 1955.                                         INCLUDE   CUSTIO.TXT
 1955.    INCLUDE  K: f:\source.cnv\custio.txt
    1. K                              .........................................................
    2. K                              .   CUSTOMER MASTER FILE I/O ROUTINES                   .
    3. K                              .........................................................
    4. K                              . 
    5. K    000023D2                  OPENCUST TRAPCLR   IO
    6. K    000023D8                           TRAP      NOCUSTO IF IO
    7. K    000023E6                           OPEN      CUSTFILE,CSTNAME
    8. K    000023F4                           MOVE      "H"    TO IOSW
    9. K    000023FE                           RETURN 
   10. K                              . 
   11. K    00002400                  NOCUSTO  BEEP 
   12. K    00002406                           DISPLAY   *ES,*P01:12,"CUSTOMER FILE NOT ON-LINE - ABORTING"
   13. K    0000240C                           STOP 
   14. K                              . 
   15. K                              . 
   16. K    0000240E                  GETCUST  TRAPCLR   IO
   17. K    00002414                           TRAP      NOCUSTO  IF  IO
   18. K                              . 
   19. K    00002422                           READ      CUSTFILE,CUSTKEY;CUSTKEY,CUSTSTTS,CUSTNAME,CUSTADDR:
   20. K                                                                  CUSTCITY,CUSTSTAT,CUSTZIP,CUSTCRED:
   21. K                                                                                            CUSTCATG:
   22. K                                                                  LSTSALDT,LSTPAYDT,LSTSALPR,LSTPAYPR:
   23. K                                                                  COMMCODE:
   24. K                                                                  CURNTDUE,PD01TO30,PD31TO60,PD61TO90:
   25. K                                                                  PDOVR90,MTDCASH,MTDCRED
   26. K                              . 
   27. K    0000242C                           GOTO      NOCUSTFD IF OVER
   28. K    00002432                           MOVE      "H"  TO  IOSW
   29. K    0000243C                           RETURN 
   30. K                              . 
   31. K                              ...........                                   CUSTADR2:
   32. K    0000243E                  NOCUSTFD MOVE      "M"  TO  IOSW
   33. K    00002448                           RETURN 
   34. K                              . 
   35. K    0000244A                  PUTCUST  TRAPCLR   IO
   36. K    00002450                           TRAP      NOCUSTFD IF  IO
   37. K    0000245E                           UPDATE    CUSTFILE;CUSTKEY,CUSTSTTS,CUSTNAME,CUSTADDR:
   38. K                                                          CUSTCITY,CUSTSTAT,CUSTZIP,CUSTCRED,CUSTCATG:



PAGE   54      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

   39. K                                                          LSTSALDT,LSTPAYDT,LSTSALPR,LSTPAYPR:
   40. K                                                          COMMCODE:
   41. K                                                          CURNTDUE,PD01TO30,PD31TO60,PD61TO90:
   42. K                                                          PDOVR90,MTDCASH,MTDCRED
   43. K    00002468                           MOVE      "H"  TO  IOSW
   44. K    00002472                           RETURN 
   45. K                              . 
   46. K                              ...........                           CUSTADR2:
   47. K                              .  END OF CUSTOMER MASTER FILE I/O ROUTINES
   48. K                              . ..........................................
 1956.                                . 
 1957.                                         INCLUDE   STDIOERR.TXT
 1957.    INCLUDE  L: f:\source.cnv\stdioerr.txt
    1. L                              .............................................................
    2. L                              .           STDIOERR ROUTINE   3/15/80 R. BACHARACH         .
    3. L                              .                                                           .
    4. L                              . THIS ROUTINE WILL BE INCLUDED INTO ALL FILE I/O BOOKS     .
    5. L                              . TO FACILITATE STANDARD I/O ERROR DETECTION AND MESSAGES   .
    6. L                              .............................................................
    7. L                              . 
    8. L    00002474                  STDIOERR BEEP 
    9. L    0000247A                           FILEPI    0
   10. L    00002484                           DISPLAY   *ES,*P01:10,"I/O ERROR ON ",IOTYPE," OF ",IOERFILE:
   11. L                                                     *P01:12,"CALL MICRO SYSTEMS CONSULTANTS....."
   12. L    0000248A                           BEEP 
   13. L    00002490                           GOTO      STDIOERR
   14. L                              . 
   15. L                              . 
 1958.                                . 
 1959.                                         INCLUDE   STDFMTER.TXT
 1959.    INCLUDE  M: f:\source.cnv\stdfmter.txt
    1. M                              .............................................................
    2. M                              .           STDFMTER ROUTINE   3/15/80 R. BACHARACH         .
    3. M                              .              STANDARD FORMAT ERROR ROUTINE                .
    4. M                              .                                                           .
    5. M                              . THIS ROUTINE WILL BE INCLUDED INTO ALL FILE I/O BOOKS     .
    6. M                              . TO FACILITATE STANDARD FORMAT ERROR DETECTION/NOTIF       .
    7. M                              .............................................................
    8. M                              . 
    9. M    00002496                  STDFMTER BEEP 
   10. M    0000249C                           FILEPI    0
   11. M    000024A6                           DISPLAY   *ES,*P01:10,"FORMAT ERROR ON ",IOTYPE," OF ",IOERFILE:
   12. M                                                     *P01:12,"CALL MICRO SYSTEMS CONSULTANTS....."
   13. M    000024AC                           BEEP 
   14. M    000024B2                           GOTO      STDFMTER
   15. M                              . 
   16. M                              . 
 1960.                                . 
 1961.                                         INCLUDE   STDRANGE.TXT
 1961.    INCLUDE  N: f:\source.cnv\stdrange.txt
    1. N                              .............................................................
    2. N                              .           STDRANGE ROUTINE   3/15/80 R. BACHARACH         .
    3. N                              .              STANDARD RANGE ERROR ROUTINE                .



PAGE   55      F:\SOURCE.CNV\APPINVCS.PLS                                                                     04-23-04 08:20:28
                                         

    4. N                              .                                                           .
    5. N                              . THIS ROUTINE WILL BE INCLUDED INTO ALL FILE I/O BOOKS     .
    6. N                              . TO FACILITATE STANDARD RANGE ERROR DETECTION/NOTIF       .
    7. N                              .............................................................
    8. N                              . 
    9. N    000024B8                  STDRANGE BEEP 
   10. N    000024BE                           FILEPI    0
   11. N    000024C8                           DISPLAY   *ES,*P01:10,"RANGE ERROR ON ",IOTYPE," OF ",IOERFILE:
   12. N                                                     *P01:12,"CALL MICRO SYSTEMS CONSULTANTS....."
   13. N    000024CE                           BEEP 
   14. N    000024D4                           GOTO      STDRANGE
   15. N                              . 
   16. N                              . 
 1962.                                . 
 1963.                                         INCLUDE   STDPARER.TXT
 1963.    INCLUDE  O: f:\source.cnv\stdparer.txt
    1. O                              .............................................................
    2. O                              .           STDPARER ROUTINE   3/15/80 R. BACHARACH         .
    3. O                              .              STANDARD PARITY ERROR ROUTINE                .
    4. O                              .                                                           .
    5. O                              . THIS ROUTINE WILL BE INCLUDED INTO ALL FILE I/O BOOKS     .
    6. O                              . TO FACILITATE STANDARD PARITY ERROR DETECTION/NOTIF       .
    7. O                              .............................................................
    8. O                              . 
    9. O    000024DA                  STDPARER BEEP 
   10. O    000024E0                           FILEPI    0
   11. O    000024EA                           DISPLAY   *ES,*P01:10,"PARITY ERROR ON ",IOTYPE," OF ",IOERFILE:
   12. O                                                     *P01:12,"CALL MICRO SYSTEMS CONSULTANTS....."
   13. O    000024F0                           BEEP 
   14. O    000024F6                           GOTO      STDPARER
   15. O                              . 
   16. O                              . 
 1964.                                . 
 1965.      000024FC                           STOP 
                                                   *WARNING*
Warning: Statement has no label and follows unconditional goto.

   Output: f:\plc\appinvcs.plc                                                                                                                                                                                                                                       
      2732 LINES;      0 ERRORS;     52 WARNINGS; Start/Stop: 08:20:24 08:20:28
  00005E04 DATA;  00002500  CODE;   SYMBOL TABLE USAGE:  UDA:   0% EXE:   0%

